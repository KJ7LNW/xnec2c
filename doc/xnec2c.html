<!DOCTYPE html>
<html lang="en">
<head>
<meta name="generator" content="Bluefish 2.2.12" >
<title>Xnec2c User Manual</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Neoklis" >
<meta name="copyright" content="GPL v2.0 or higher">
<meta name="keywords" content="xnec2c GTK3 graphical nec2c NEC2 C simplex EM simulator">
<meta name="description" content="Xnec2c is a high-performance multi-threaded electromagnetic simulation package to model antenna near- and far-field radiation patterns for Linux and UNIX operating systems.  The original FORTRAN version of NEC2 was ported to C by Neoklis Kyriazis, 5B4AZ and released as nec2c.  Later, he wrote xnec2c a graphical interface for ease of use with many more features.">
<meta name="ROBOTS" content="INDEX, FOLLOW">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="canonical" href="https://www.xnec2c.org/" />
<script>
document.addEventListener('DOMContentLoaded', function() {
  // URL mapping configuration
  const urlMap = {
    'version-tag': 'https://github.com/KJ7LNW/xnec2c/tree/{value}',
    'commit-hash': 'https://github.com/KJ7LNW/xnec2c/commit/{value}',
    'issue-ref': 'https://github.com/KJ7LNW/xnec2c/issues/{value}',
    'callsign': 'https://www.qrz.com/db/{value}',
    'github-user': 'https://github.com/{value}',
    'filepath': 'https://github.com/KJ7LNW/xnec2c/tree/master/{value}'
  };

  // Universal auto-linking function
  function createAutoLinks(className) {
    const template = urlMap[className];
    if (!template) return;

    document.querySelectorAll('.' + className).forEach(function(el) {
      let value = el.textContent.trim();

      // Special handling for different types
      if (className === 'github-user') {
        value = value.replace('@', '');
      } else if (className === 'issue-ref') {
        value = value.replace('#', '');
      } else if (className === 'version-tag') {
        // Ensure version tags have 'v' prefix for the URL
        if (!value.startsWith('v')) {
          value = 'v' + value;
        }
      }

      const link = document.createElement('a');
      link.href = template.replace('{value}', value);
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.textContent = el.textContent;
      link.className = className + '-link';
      el.replaceWith(link);
    });
  }

  // Apply to all configured classes
  Object.keys(urlMap).forEach(createAutoLinks);
});
</script>
<style>
/* Radiation Pattern Inspired Color Scheme */
:root {
  /* Primary gradient colors from antenna pattern */
  --color-primary: #1e40af;        /* Deep blue */
  --color-primary-dark: #1e3a8a;
  --color-primary-light: #3b82f6;

  --color-secondary: #0284c7;      /* Sky blue */
  --color-secondary-dark: #0369a1;
  --color-secondary-light: #0ea5e9;

  --color-accent: #0891b2;         /* Cyan */
  --color-accent-dark: #0e7490;
  --color-accent-light: #06b6d4;

  --color-success: #059669;        /* Emerald green */
  --color-warning: #d97706;        /* Amber */
  --color-error: #dc2626;          /* Red */

  /* Neutral palette */
  --color-base-100: #ffffff;
  --color-base-200: #f8fafc;
  --color-base-300: #e2e8f0;
  --color-base-content: #1e293b;
  --color-neutral: #334155;
  --color-neutral-light: #64748b;

  /* Gradient colors for visualization */
  --gradient-cold: #1e40af;        /* Deep blue */
  --gradient-cool: #3b82f6;        /* Blue */
  --gradient-mid-cool: #0891b2;    /* Cyan */
  --gradient-mid: #059669;         /* Green */
  --gradient-mid-warm: #ca8a04;    /* Yellow */
  --gradient-warm: #ea580c;        /* Orange */
  --gradient-hot: #dc2626;         /* Red */
}

/* Base Typography */
body {
  font-family: Georgia, Cambria, "Times New Roman", serif;
  line-height: 1.6;
  color: var(--color-base-content);
  background-color: var(--color-base-100);
  margin: 2rem;
}

/* Navigation */
nav, nav * {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

/* Headings */
h1 {
  color: var(--color-primary);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 2.5rem;
  font-weight: 700;
  margin: 0.5rem 0 1.5rem;
  border-bottom: 3px solid var(--color-primary);
  padding-bottom: 0.75rem;
  letter-spacing: -0.025em;
}

h1:first-of-type {
  margin-top: 0;
}

h2 {
  color: var(--color-primary-dark);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 2rem;
  font-weight: 600;
  margin: 3rem 0 1.25rem;
  border-bottom: 2px solid var(--color-base-300);
  padding-bottom: 0.5rem;
  letter-spacing: -0.02em;
}

h3 {
  color: var(--color-secondary-dark);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 1.5rem;
  font-weight: 600;
  margin: 2rem 0 1rem;
  letter-spacing: -0.015em;
}

h4 {
  color: var(--color-neutral);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 1.25rem;
  font-weight: 600;
  margin: 1.5rem 0 0.75rem;
}

/* Links */
a {
  color: var(--color-primary);
  text-decoration: none;
  transition: color 0.2s;
}

a:hover {
  color: var(--color-primary-light);
  text-decoration: underline;
}

a:visited {
  color: var(--color-primary-dark);
}

/* Menu Paths */
.menu-path {
  background: linear-gradient(135deg, var(--color-base-200), var(--color-base-300));
  padding: 0.2rem 0.5rem;
  border-radius: 0.25rem;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  font-size: 0.95em;
  white-space: nowrap;
  display: inline-block;
  margin: 0 0.25rem;
  border: 1px solid var(--color-base-300);
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.menu-path::after {
  content: '';
}

/* Make arrow separators in menu paths more prominent */
.menu-path + .menu-path::before {
  content: '→';
  font-weight: bold;
  font-size: 1.2em;
  margin: 0 0.3rem;
  color: var(--color-primary);
  vertical-align: middle;
}

/* Keyboard Shortcuts */
kbd {
  background: linear-gradient(180deg, #fff, var(--color-base-200));
  border: 1px solid var(--color-base-300);
  border-radius: 0.25rem;
  box-shadow: 0 2px 0 rgba(0,0,0,0.1), inset 0 0 0 2px #fff;
  color: var(--color-neutral);
  display: inline-block;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  font-size: 0.85em;
  font-weight: 600;
  padding: 0.15rem 0.4rem;
  margin: 0 0.15rem;
  vertical-align: baseline;
}

/* Spacing utilities */
.space-sm {
  margin-bottom: 0.5rem;
}

.space-md {
  margin-bottom: 1rem;
}

.space-lg {
  margin-bottom: 2rem;
}

.section-spacing {
  margin-bottom: 2rem;
}

/* Code Elements */
code, tt {
  background-color: #f1f5f9;
  border: 1px solid #cbd5e1;
  border-radius: 0.25rem;
  padding: 0.15rem 0.4rem;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  font-size: 0.9em;
  color: var(--color-accent-dark);
  font-weight: 500;
}

/* Scientific notation */
sub, sup {
  font-size: 0.75em;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

.nec-card {
  background-color: var(--color-base-200);
  border: 1px solid var(--color-base-300);
  border-radius: 0.25rem;
  padding: 0.15rem 0.4rem;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  font-size: 0.9em;
  color: var(--color-accent-dark);
  font-weight: 600;
}

.version-number {
  color: var(--color-success);
}

pre {
  background-color: var(--color-base-200);
  border: 1px solid var(--color-base-300);
  border-radius: 0.5rem;
  padding: 1rem;
  overflow-x: auto;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  line-height: 1.4;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
}

pre code {
  background: none;
  border: none;
  padding: 0;
  color: inherit;
}

/* File Paths */
.filepath {
  background-color: var(--color-base-200);
  color: var(--color-success);
  padding: 0.1rem 0.3rem;
  border-radius: 0.25rem;
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  font-size: 0.9em;
  white-space: nowrap;
}

/* Definition Lists */
dl {
  margin: 1.5rem 0;
  background-color: var(--color-base-100);
  border-left: 4px solid var(--color-accent);
  padding-left: 1.5rem;
}

dt {
  font-weight: 600;
  color: var(--color-primary);
  margin-top: 1.25rem;
  font-size: 1.1em;
}

dt code {
  font-size: 1.05em;
  color: var(--color-accent-dark);
  background-color: var(--color-base-200);
  border: 1px solid var(--color-base-300);
  padding: 0.15rem 0.4rem;
}

dd {
  margin-left: 2rem;
  margin-bottom: 1.25rem;
  color: var(--color-base-content);
  line-height: 1.7;
}

/* Definition Tables */
table.definition-table {
  margin: 1.5rem 0;
  border-collapse: collapse;
}

table.definition-table th {
  background-color: var(--color-primary);
  color: white;
  text-align: left;
  padding: 0.75rem;
}

table.definition-table td {
  padding: 0.75rem;
  border-bottom: 1px solid var(--color-base-300);
}

table.definition-table tr:hover {
  background-color: var(--color-base-200);
}

/* Images */
img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5rem;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

img.float-left {
  float: left;
  margin: 1rem 2rem 1rem 0;
}

img.float-right {
  float: right;
  margin: 1rem 0 1rem 2rem;
}

/* Lists */
ul, ol {
  margin: 1rem 0;
  padding-left: 1.5rem;
}

li {
  margin: 0.5rem 0;
}

/* Nested lists */
ul ul, ul ol, ol ul, ol ol {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  padding-left: 1.25rem;
}

/* Paragraphs */
p {
  margin: 1rem 0;
  text-align: justify;
}

/* Tables (for future use) */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem 0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

th {
  background-color: var(--color-primary);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 600;
}

td {
  padding: 0.75rem;
  border-bottom: 1px solid var(--color-base-300);
}

tr:hover {
  background-color: var(--color-base-200);
}

/* Buttons (for interactive elements) */
button, input[type="button"], input[type="submit"] {
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  color: white;
  border: none;
  padding: 0.5rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(139, 92, 246, 0.3);
}

/* Responsive Design */
@media (max-width: 768px) {
  body {
    margin: 1rem;
  }

  h1 {
    font-size: 2rem;
  }

  h2 {
    font-size: 1.5rem;
  }

  h3 {
    font-size: 1.25rem;
  }

  img.float-left,
  img.float-right {
    float: none;
    display: block;
    margin: 1rem auto;
  }

  /* Reduce list indentation on mobile */
  ul, ol {
    padding-left: 1.25rem;
  }

  ul ul, ul ol, ol ul, ol ol {
    padding-left: 1rem;
  }
}

/* Print Styles */
@media print {
  body {
    color: black;
    background: white;
  }

  a {
    color: black;
    text-decoration: underline;
  }

  .menu-path, kbd {
    border: 1px solid #ccc;
    background: white;
  }
}

/* Scientific notation helpers */
.subscript {
  vertical-align: sub;
  font-size: 0.75em;
}

.superscript {
  vertical-align: super;
  font-size: 0.75em;
}

.impedance {
  font-style: italic;
}

/* Accessibility */
:focus {
  outline: 3px solid var(--color-accent);
  outline-offset: 2px;
}

/* Skip to main content link */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-primary);
  color: white;
  padding: 8px;
  text-decoration: none;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}

/* Version history styling */
.version-history h3 {
  color: var(--color-success);
  border-left: 4px solid var(--color-success);
  padding-left: 0.5rem;
}

/* Auto-link styling */
.version-tag-link {
  /* Version tags link to GitHub releases */
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  color: var(--color-success);
  font-weight: 600;
}

.commit-hash-link {
  /* Commit hashes link to GitHub commits */
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  background-color: var(--color-base-200);
  padding: 0.1rem 0.3rem;
  border-radius: 0.25rem;
  color: var(--color-accent-dark);
  font-size: 0.9em;
}

.issue-ref-link {
  /* Issue references link to GitHub issues */
  color: var(--color-primary);
  font-weight: 500;
}

.callsign-link {
  /* Callsigns are auto-linked to QRZ.com */
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  color: var(--color-primary);
}

.github-user-link {
  /* GitHub usernames link to profiles */
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  color: var(--color-primary);
}

/* Translation notice */
#translate {
  background-color: var(--color-base-200);
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  margin-bottom: 1rem;
  text-align: center;
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

/* Selection colors */
::selection {
  background-color: var(--color-accent-light);
  color: var(--color-base-content);
}

::-moz-selection {
  background-color: var(--color-accent-light);
  color: var(--color-base-content);
}

/* Navigation and Table of Contents - sans-serif for scanability */
nav, nav ol, nav ul, nav li, nav a {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

/* Definition table for button descriptions */
.definition-table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem 0;
}

.definition-table th {
  text-align: left;
  font-weight: normal;
  padding: 0.5rem 1rem 0.5rem 0;
  vertical-align: top;
  white-space: nowrap;
}

.definition-table td {
  padding: 0.5rem 0 0.5rem 1rem;
  border-left: 2px solid var(--color-base-300);
}

/* Language-specific code highlighting */
.language-bash, .language-shell {
  background-color: #f6f8fa;
  display: block;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
}

.language-c {
  color: #032f62;
  font-weight: 500;
}

.language-gnuplot {
  color: #1f2328;
  background-color: #fff8f0;
}

.math-expression {
  font-family: "Cambria Math", "Times New Roman", serif;
  font-style: italic;
  color: #6e4c13;
}

/* Notice blocks - small aside boxes that float right */
.notice {
  float: right;
  width: 35%;
  max-width: 300px;
  background-color: var(--color-base-200);
  border-left: 3px solid var(--color-accent);
  padding: 0.75rem;
  margin: 0 0 1rem 1.5rem;
  border-radius: 0.25rem;
  font-size: 0.9em;
  line-height: 1.4;
  clear: right;
}

.notice strong {
  color: var(--color-accent-dark);
  font-size: 0.95em;
  display: block;
  margin-bottom: 0.25rem;
}

.notice h4 {
  margin: 0 0 0.5rem 0;
  font-size: 1em;
  color: var(--color-accent-dark);
}

.notice p {
  margin: 0.5rem 0;
  text-align: left;
}

/* Clear floats after sections */
h2, h3 {
  clear: both;
}

/* For smaller screens, make notices full width */
@media (max-width: 768px) {
  .notice {
    float: none;
    width: 100%;
    max-width: none;
    margin: 1rem 0;
  }
}

/* UI Elements */
.ui-button {
  font-weight: 600;
  color: var(--color-primary-dark);
}

kbd.shortcut {
  margin-left: 0.5rem;
}

/* Figure captions */
figcaption {
  font-style: italic;
  text-align: center;
  margin-top: 0.5rem;
  color: var(--color-neutral);
  font-size: 0.95em;
}

/* Button table specific styling */
.button-table {
  width: 100%;
  table-layout: fixed;
}

.button-table th:first-child {
  width: 20%;
}

.button-table th:nth-child(2) {
  width: 15%;
}

.button-table th:nth-child(3) {
  width: 65%;
}

/* Signal names */
.signal {
  font-family: "Consolas", "Monaco", "Courier New", monospace;
  color: #e16f24;
  font-weight: 600;
  background-color: #fff8f0;
  padding: 0.15rem 0.4rem;
  border-radius: 0.25rem;
}

/* Command-line options definition list */
.command-options dt {
  font-size: 1em;
  font-weight: normal;
  margin-top: 0.75rem;
  margin-bottom: 0.25rem;
}

.command-options dt code {
  font-size: 0.95em;
  font-weight: 600;
  background-color: var(--color-base-200);
  padding: 0.2rem 0.4rem;
  border-radius: 0.25rem;
  color: var(--color-primary-dark);
}

.command-options dd {
  margin-left: 2rem;
  margin-bottom: 0.75rem;
  color: var(--color-base-content);
}
</style>
<link rel="stylesheet" href="mobile-styles.css">
<script src="mobile-menu.js" defer></script>
</head>
<body>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en'}, 'translate');
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<div id="translate"></div>
<h1>Xnec2c: Graphical NEC2 Antenna Simulation</h1>
<figure>
<a href="https://www.xnec2c.org/" target="_blank" rel="noopener noreferrer"><img src="images/web-heading.png" alt="Xnec2c logo and heading" loading="lazy"/></a>
</figure>
Xnec2c is a high-performance multi-threaded electromagnetic simulation
package to model antenna near- and far-field radiation patterns
for Linux and UNIX operating systems.  The original FORTRAN version of
NEC2 was ported to C by <a target="_blank" rel="noopener noreferrer" href="https://www.5b4az.org/">Neoklis Kyriazis, <span class="callsign">5B4AZ</span></a> and released as nec2c.
Later he wrote xnec2c, a graphical interface for ease of use with
many more features:

<h2>Xnec2c Quick Start Guide</h2>

<h3>Compilation</h3>
<ul>
<li><code>git clone https://github.com/KJ7LNW/xnec2c.git</code></li>
<li><code>cd xnec2c</code></li>
<li><code>./autogen.sh</code></li>
<li><code>./configure</code></li>
<li><code>make &amp;&amp; make install</code></li>
<li><code>make desktop-install</code> # Optional: for icons and file association.</li>
<li><code>xnec2c</code></li>
</ul>

<h3>Compilation Notes</h3>

If you prefer to download <span class="filepath">.tar.gz</span> files they are available on our
<a target="_blank" rel="noopener noreferrer" href="https://www.xnec2c.org/releases/?C=M;O=D">releases</a> page.

<ul>
	<li>
	You will need the Gnome development libraries and build tools installed for your distribution:
	<ul>
		<li>Debian/Ubuntu: <code>apt-get install build-essential autoconf libtool gnome-devel libgtk-3-dev gettext autopoint gnome-icon-theme desktop-file-utils</code></li>
		<li>CentOS: <code>yum install gcc make automake autoconf gtk3-devel gettext-devel libtool</code></li>
		<li>Note: some distributions may need the <code>autoconf-archive</code> package.
	</ul>
	</li>
	<li>
	If you have trouble running <code>./autogen.sh</code> then try <code>autoreconf -v -i -W all</code> instead; its
	output may be more informative and indicate the actual issue.
	</li>
	<li>
	If you have trouble building on any OS then please open an issue on the <a target="_blank" rel="noopener noreferrer" href="https://github.com/KJ7LNW/xnec2c/issues">github issues</a> page so we can make xnec2c build on as many systems as possible.
	</li>
</ul>

<h3>Getting Started</h3>
<ol>
<li>Open a simple antenna like <span class="filepath">examples/2m_yagi.nec</span> because it will render quickly.</li>
<li>In the main window, select <span class="menu-path">View → Radiation Pattern</span> and <span class="menu-path">View → Frequency Plots</span></li>
<li>In the Freqplots window, select "Max Gain" and "VSWR" (or whichever you'd like to see).</li>
<li>Click the triangle "Play" button on the freqplots window to render the graph.</li>
<li>Click anywhere in the plot window to select a frequency (green line)</li>
<li>Drag the radiation pattern around and have a look!</li>
</ol>


<h3>Performance Tips</h3>
<ul>
<li>Launch xnec2c with as many jobs as you have CPUs; for example: <code>xnec2c -j8</code></li>
<li>Configure accelerated LAPACK libraries.  See <span class="menu-path">File → Mathlib Libraries → Mathlib Help</span></li>
</ul>



<h3>Contribute to Xnec2c</h3>
<p>If you wish
to contribute to the xnec2c project then we would welcome your
support and pull-requests at the
<a target="_blank" rel="noopener noreferrer" href="https://github.com/KJ7LNW/xnec2c">official xnec2c GitHub repository</a>
</p>

<h2>User's Manual</h2>
<nav role="navigation" aria-label="Table of Contents">
<ol>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Features">Features</a>
<ul>
<li><a href="#Multithread">Multi-threaded operation on SMP machines</a></li>
<li><a href="#OnDemand">On-demand Calculation</a></li>
<li><a href="#Nec2Edit">Built-in NEC2 input file editor</a></li>
<li><a href="#Linalg">Accelerated Linear Algebra Support</a></li>
<li><a href="#Interactive">Interactive Operation</a></li>
<li><a href="#Windows">User Interface</a></li>
<li><a href="#Color">Color Coding</a></li>
</ul>
</li>
<li><a href="#Compilation">Compilation and Installation</a></li>
<li><a href="#Operation">Operation</a>
<ul>
<li><a href="#CommandLine">Command Line Options</a></li>
<li><a href="#MainWindow">The Main Window</a></li>
<li><a href="#RadiationWindow">The Radiation Pattern
Window</a></li>
<li><a href="#FrequencyWindow">Frequency Data Plots</a></li>
<li><a href="#Nec2Treeview">NEC2 Input File Editor</a></li>
<li><a href="#Optimization">Antenna Geometry Optimization (ie, high gain, low VSWR)</a></li>
<li><a href="#Optimizers">External Optimizers</a></li>
</ul>
</li>
<li><a href="#InputFile">Input File Considerations and NEC2 Card Reference</a></li>
<li><a href="#OutputFile">Output File Considerations</a></li>
<li><a href="#Version">Version History</a></li>
<li><a href="#Limitations">Limitations</a></li>
<li><a href="#Bugs">Bugs and Inadequacies</a></li>
<li><a href="#Acknowledgement">Acknowledgment</a></li>
</ol>
</nav>
<main role="main">
<h2 id="Introduction">Introduction</h2>
<p>Xnec2c is a GTK3-based Graphical version of nec2c, my
translation to the C language of NEC2, the FORTRAN Numerical
Electromagnetics Code commonly used for antenna simulation and
analysis. The original nec2c is a non-interactive command-line
application that reads standard NEC2 input files and produces an
output file with data requested by "commands" in the input file. In
contrast xnec2c is a GUI interactive application that (in its
current form) reads NEC2 input files but presents output data in
graphical form, e.g.&nbsp;as wire frame drawings of the radiation
pattern or near E/H field, graphs of maximum gain, input impedance,
VSWR etc against frequency and simple rendering of the antenna
structure, including color code representation of currents or
charge densities. These results are only calculated and drawn on
user demand via menu items or buttons, e.g.&nbsp;xnec2c is interactive
and does not execute NEC2 "commands" in batch style as the original
does. Printing of results to an output file has been removed
starting from <span class="version-tag">v1.0</span>, since xnec2c works in a way that does
not allow printing compatible with the NEC2 format. If printing to
file is needed then it is better to use the original NEC2 program,
to avoid bugs that may still be lurking in the C translation.</p>
<p>Xnec2c now has a built-in editor for NEC2 input files which can
be used to edit geometry or command "card" data. This basic editor
displays comment, geometry and command cards in tree views where
individual rows, each representing a card, can have their cells
edited directly for "raw" entry of data. More useful are pop-up
"editor" windows that open when appropriate buttons are clicked or
when a selected row is right-clicked with the mouse. These editors
allow easier, more convenient entry and editing of individual rows,
with no need for detailed knowledge of "card" formats. When editing
is completed, the contents of the nec2 editor can be saved in a
NEC2-compatible input file which can then be re-loaded by xnec2c
for execution.</p>
<h2 id="Features">Features</h2>
</ul>
<h3 id="Multithread">Multi-threading operation on SMP machines</h3>
<p>Since <span class="version-tag">v1.0</span>, xnec2c can run multi-threaded (by forking) on
SMP machines, when executing a frequency loop. Multi-threading is
enabled by using the <code>-j &lt;n&gt;</code> option, where <var>n</var> is the number of
processors in a SMP machine. xnec2c will spawn <var>n</var> child processes,
to which it will delegate calculation of frequency-dependent data
for each frequency step. Thus data related to <var>n</var> frequency steps
will be calculated concurrently and passed on the the parent
process by pipes, to be further processed for graphical display.
Child processes are spawned before GTK is initialized and started
so that only the parent process is tied to the GUI interface. Thus
there are <var>n</var>+1 processes running when the <code>-j</code> option is used and
execution is faster by slightly less than <var>n</var> times.</p>
<aside class="notice" role="note">
<strong>Note:</strong> its pointless and counter-productive to specify a
value of <var>n</var> greater than the number of steps in the frequency
loop.
</aside>

<h3 id="OnDemand">On-demand Calculation</h3>
<p>
Since xnec2c collects data to be displayed in buffers directly from
the functions that produce them, there is no need to produce and
parse an output file and no need to re-run the program when certain
input data (currently the frequency) is changed or when different
output data (gain, near-fields, input impedance etc) is required.
The frequency can be changed either from spin buttons in the
<a href="#MainWindow">Main</a> and <a href=
"#RadiationWindow">Radiation Pattern</a> windows or by clicking on
the <a href="#FrequencyWindow">Frequency Data</a> window's graph
drawing area. The frequency corresponding to the pointer position
will then be used to re-calculate whatever data is on display.</p>

<h3 id="Nec2Edit">Built-in NEC2 input file editor</h3>
<p>
Xnec2c has a built-in editor for NEC2 input files. Data in NEC2
"cards" can be entered or edited either directly in the main editor
window (tree view) or in more convenient dedicated editors for each
type of card. Edited data can be saved to a NEC2 input file and
reloaded for execution so that the edit-execute-display cycle is
quicker and more convenient.</p>

<h3 id="Linalg">Accelerated Linear Algebra Support</h3>
<p>
Support for accelerated libraries was added in <span class="version-tag">v4.3</span>.
Accelerated math libraries such as ATLAS, OpenBLAS and Intel MKL
can speed up xnec2c EM simulations if available on your platform.
Library detection details are available in the terminal. See
<span class="menu-path">File → Math Libraries → Help</span> for more information. Accelerated operation
is optional, it will fall back to the original NEC2 algorithms if
necessary.  Accelerated library support has been tested on Ubuntu
, Debian, CentOS/RHEL, and VOID Linux.
Generally speaking, if you can install the requisite libraries,
it will be detected.  If libraries are not detected on your OS then
please open a bug report.</p>

<h3 id="Interactive">Interactive Operation</h3>
<p>
Xnec2c is interactive in its operation, e.g.&nbsp;when started it just
shows its Main window in a "blank" state, indicating that no valid
input data has been read in yet. The NEC2-type input file can be
specified at start-up in the command line optionally with the <strong><code>-i</code>
option</strong> or it can be opened from the file selection dialog that
appears via the <span class="menu-path">File → Open</span> menu of the <a href=
"#MainWindow">Main window</a>. Once a valid input file is opened,
all the normal widgets in the <a href="#MainWindow">Main window</a>
appear so as to allow proper operation. The NEC2 "commands" in the
input file are read in but not executed, until a request is issued
by the user via buttons or menus in the appropriate windows.</p>

<h3 id="Windows">User Interface</h3>
In its current form, xnec2c has three windows for the graphical
display of output data: When started without an input file
specified optionally by the <code>-i &lt;input-file&gt;</code> option, the
<a href="#MainWindow">Main window</a> opens with most of the button
and menu widgets hidden. When a valid input file is opened, all the
hidden widgets are shown and the structure is drawn in the <a href=
"#MainWindow">Main window's</a> drawing area widget. From the
<strong>View</strong> menu, the <a href="#RadiationWindow">Radiation
Pattern</a> and <a href="#FrequencyWindow">Frequency Related
data</a> display windows can be opened, to draw either the Gain
pattern or the Near E/H fields or Frequency-related Data like Input
Impedance, VSWR, Max gain, F/B Ratio, Gain in the Viewer's
direction etc. Both the <a href="#MainWindow">Main window</a> and
the <a href="#RadiationWindow">Radiation Pattern window</a> have
buttons to select fixed viewing angles of the structure or the
radiation pattern, as well as spin buttons to input specific
viewing angles.

<h3 id="Color">Color Coding</h3>
<p>
Xnec2c uses color coding to visualize the Current or Charge
distribution in the Structure's segments or patches as well as the
Gain pattern or the Near E/H field pattern. Color coding is also
used to clarify the Graphs of Frequency-related data. A color code
strip is shown in the <a href="#MainWindow">Main</a> and <a href=
"#RadiationWindow">Radiation Pattern</a> windows.</p>
<h2 id="Compilation">Compilation and Installation</h2>
<p>
Xnec2c is known to build on many different platforms including Linux
and by using <a target="_blank" rel="noopener noreferrer" href="https://www.freshports.org/comms/xnec2c/">FreeBSD FRESH ports</a>.
If you have trouble building on your OS then please open a bug report.
</p>
<p>To compile the package, it may be preferable to first run the
included <span class="filepath">autogen.sh</span> script in the package's top directory, to
produce a fresh build environment. Then the <code>configure</code> script can
be run with optional parameters to override the default settings
and compiler flags, e.g: <code>./configure --prefix=/usr CFLAGS="-g -O2"</code>
will override the default <span class="filepath">/usr/local</span> installation prefix and the
<code>-Wall -O2</code> compiler flags.</p>
<p>Running <code>make</code> in the package's top directory should produce the
executable binary in <span class="filepath">src/</span>. Running <code>make install</code> will install the
binary into <span class="filepath">/usr/local/bin</span> by default or under the specified
prefix. It will also install the default configuration file into
the user's home directory. This will have to be edited by the user
as required. There is also this hypertext documentation file which
you can copy to a location of your choice.</p>
<p>No configuration files are needed and the sample input files
that were used during development are in the <span class="filepath">examples</span>
directory. Please also read the <strong><span class="filepath">doc/nec2c.txt</span></strong> file
that describes the nec2c application that is used as the basis for
xnec2c.</p>
<h2 id="Operation">Operation</h2>
<h3 id="CommandLine">Command Line Options</h3>
<p><strong>Usage:</strong> <code>xnec2c [options] [&lt;<var>input-file-name</var>&gt;]</code></p>

<dl class="command-options">
  <dt><code>-i|--input &lt;input-file-name&gt;</code></dt>
  <dd>Specify a NEC2 input file to be opened at start-up.</dd>

  <dt><code>-j|--jobs &lt;n&gt;</code></dt>
  <dd>Number of processors in SMP machine, where <var>n</var> is the number of processors (<code>-j0</code> disables forking).</dd>

  <dt><code>--openblas-threads &lt;n&gt;</code></dt>
  <dd>Set OpenBLAS thread count (default: 1).</dd>

  <dt><code>--mkl-threads &lt;n&gt;</code></dt>
  <dd>Set Intel MKL thread count (default: 1).</dd>

  <dt><code>--omp-threads &lt;n&gt;</code></dt>
  <dd>Set OpenMP thread count (default: 1).</dd>

  <dt><code>-b|--batch</code></dt>
  <dd>Enable batch mode, exit after the frequency loop runs.</dd>

  <dt><code>--optimize</code></dt>
  <dd>Activate the optimizer immediately.</dd>

  <dt><code>-P|--no-pthreads</code></dt>
  <dd>Disable pthreads and use the GTK loop for debugging.</dd>

  <dt><code>-h|--help</code></dt>
  <dd>Print usage information and exit.</dd>

  <dt><code>-V|--version</code></dt>
  <dd>Print xnec2c version number and exit.</dd>

  <dt><code>-v|--verbose</code></dt>
  <dd>Increase verbosity, can be specified multiple times.</dd>

  <dt><code>-d|--debug</code></dt>
  <dd>Enable debug output (<code>-dd</code> includes backtraces).</dd>

  <dt><code>-q|--quiet</code></dt>
  <dd>Suppress debug/verbose output.</dd>

  <dt><code>-c|--config &lt;config-file-path&gt;</code></dt>
  <dd>Specify an existing config file to use (file must exist).</dd>

  <dt><code>-C|--new-config &lt;new-config-file-path&gt;</code></dt>
  <dd>Specify a new config file path (creates the file if missing).</dd>

  <dt><code>--skip-verify</code></dt>
  <dd>Skip geometry verification checks.</dd>

  <dt><code>--force-verify</code></dt>
  <dd>Force overlap check on large models (models with more than 1000 segments).</dd>
</dl>

<p>The following arguments write to an output file after the frequency loop
completes. These are useful to combine with <code>--batch</code>; If you wish to specify
filenames to write without <code>--batch</code> mode then enable the <span class="menu-path">File → Optimizer Settings</span> or the files you specify on the command line will not be written.</p>

<dl class="command-options">
  <dt><code>--write-csv &lt;filename&gt;</code></dt>
  <dd>Write results in CSV format.</dd>

  <dt><code>--write-s1p &lt;filename&gt;</code></dt>
  <dd>Write S1P Touchstone file.</dd>

  <dt><code>--write-s2p-max-gain &lt;filename&gt;</code></dt>
  <dd>Write S2P file using maximum gain.</dd>

  <dt><code>--write-s2p-viewer-gain &lt;filename&gt;</code></dt>
  <dd>Write S2P file using viewer gain.</dd>
</dl>
<h4>Command Line Notes</h4>
<p><strong>&lt;<var>input-file-name</var>&gt;</strong>: Specify a NEC2 input file to
be opened at start-up. If the <code>-i</code> option is omitted, xnec2c will
take the last argument to be the input file path name, but will
only open it if it has the <span class="filepath">.nec</span> extension.</p>
<p><strong>&lt;<var>number of child processes to spawn</var>&gt;</strong>: Since
<span class="version-tag">v1.0</span> xnec2c can run multi-threaded on SMP machines. This
option specifies the number of child processes to spawn by forking,
so that the total number of processes running will be <var>n</var>+1. <var>n</var> should
be equal to the number of processors in a SMP machine.</p>
<aside class="notice" role="note">
<strong>Note:</strong> its pointless and counter-productive to specify a
value of <var>n</var> greater than the number of steps in the frequency
loop, or greater than the number of logical CPUs on your system.
</aside>
<p>Starting in <span class="version-tag">v4.3</span>, xnec2c always forks at least one job
for better UI responsiveness.  If you wish to disable forking for
debug or testing then specify <code>-j0</code>.</p>
<h3 id="MainWindow">The Main Window</h3>
<figure>
<img src="images/currents.png" class="float-left" alt="Main window showing current distribution on antenna structure" loading="lazy">
<figcaption>Main window showing current distribution on antenna structure</figcaption>
</figure>
<aside class="notice" role="note">
<strong>Note:</strong> As of <span class="version-tag">v3.7-beta</span>, many buttons and menu items
have been given keyboard accelerators and these are denoted in
brackets, after the mention of these widgets in the manual's
text.
</aside>
When starting xnec2c from a terminal or from a file manager (by
OLE), the <code>-i</code> option can be used to specify a NEC2 input file:
<code>xnec2c -i <span class="filepath">~/nec2/turnstile.nec</span></code>. Otherwise an input file can
be opened from the Main window's <span class="menu-path">File → Open</span> menu <kbd class="shortcut">o</kbd>
item. If the input file is valid, xnec2c will render the structure
specified in the Geometry section of the file in the Main window's
drawing area. The background color is black and the structure is
rendered in blue. The excitation points (segments) are rendered in
red, the x, y, z axis in white, loaded segments in yellow,
transmission lines in cyan and two-port networks in magenta. These
colors are hard-coded in the source code and at this stage of
development there is no option to change them.
<p>Once an input file is opened, the structure display can be
rotated around the Z axis and tilted about a horizontal axis
through the origin. This can be done either by pressing button #1
and dragging the structure with the mouse pointer, clicking the
<span class="ui-button">X</span> (<kbd class="shortcut">x</kbd>), <span class="ui-button">Y</span> (<kbd class="shortcut">y</kbd>), <span class="ui-button">Z</span> (<kbd class="shortcut">z</kbd>), or <span class="ui-button">Default</span> (<kbd class="shortcut">d</kbd>)
view button (45° rotation and tilt). The actual value of
rotation and tilt is shown in two spin button widgets which can
also be used to change the viewing angle.</p>
<p>Starting with <span class="version-tag">v2.1</span>, the structure display can be zoomed
in or out by using the mouse wheel or the Zoom controls: <span class="ui-button">Zoom %</span> spin wheel and the <span class="ui-button">Zoom In</span> (<kbd class="shortcut">Ctrl+Plus</kbd>), <span class="ui-button">Zoom Out</span> (<kbd class="shortcut">Ctrl+Minus</kbd>), and <span class="ui-button">Zoom 100%</span> (<kbd class="shortcut">Ctrl+1</kbd>) buttons and it can also be moved around by dragging
with the right mouse button #2.</p>
<p>The current distribution or charge density in the structure can
be displayed by clicking the <span class="ui-button">Currents</span> (<kbd class="shortcut">i</kbd>) or <span class="ui-button">Charges</span> (<kbd class="shortcut">v</kbd>) toggle buttons at the top right of the Main window. The
distribution of current or charges is rendered by a color code, red
for the maximum value and magenta for zero. The Frequency Loop
control buttons can be used to Start, Pause or Reset the loop.
There is a <span class="ui-button">Color Code</span> bar at the left of the second row of
widgets in the Main window, indicating the color coding and the
maximum value of the displayed quantity (at its right).</p>
<p>The title in the border of the drawing area widget shows the
user-selected function of the display, while the text entry widget
at the right of the color code bar shows antenna gain in the Viewer
direction, e.g.&nbsp;perpendicular to the Screen. To the right of this
the <span class="ui-button">Frequency Spin Button</span> shows the current frequency in&nbsp;MHz
for which the current/charge distribution and Viewer gain are
calculated and displayed. If the <span class="ui-button">Redo Check box</span> is active,
each time the frequency is changed in the spin button, all relevant
data on display will be recalculated. If not, clicking the Redo
button will initiate recalculation.</p>
<p>Printing of results to an output file has been removed starting
from <span class="version-tag">v1.0</span>, since xnec2c works in a way that does not allow
printing compatible with the NEC2 format. If printing to file is
needed then it is better to use the original NEC2 program, to avoid
bugs that may still be lurking in the C translation. Otherwise, it
is possible to save the structure drawing to a PNG file by using
the <span class="ui-button">Save</span> (<kbd class="shortcut">s</kbd>) or <span class="ui-button">Save As</span> (<kbd class="shortcut">Ctrl+s</kbd>) items in the File
menu.</p>
<p>Starting with <span class="version-tag">v2.1</span>, xnec2c can save the structure display
as a data file for the <code>gnuplot</code> plotting program. This is done by
using the <span class="menu-path">File → Save As gnuplot</span> menu item, to open a file
chooser dialog. If only the stem of the file name is given, xnec2c
will automatically add the <span class="filepath">.gplot</span> extension. Plotting in gnuplot is
done with the <code class="language-gnuplot">splot &lt;<var>filename</var>&gt; with lines</code> command, although
the plot can be enhanced with some of the style etc commands
available in gnuplot.</p>
<p>The <span class="ui-button">View</span> menu allows opening of other output data display
windows and selection of various options:
The <span class="menu-path">Radiation Pattern</span> menu (<kbd class="shortcut">r</kbd>) item opens the <a href=
"#RadiationWindow">Radiation Pattern window</a> so that the Gain
pattern or the Near E/H fields can be calculated and displayed.
The <span class="menu-path">Frequency Data</span> menu (<kbd class="shortcut">f</kbd>) item opens the <a href=
"#FrequencyWindow">Frequency Data Plots window</a> which allows the
plotting of various frequency-related data against the frequency
range specified in the <code class="nec-card">FR</code> command. It also allows quick selection
of the current frequency and recalculation of data by clicking on
the plots drawing area.
The <span class="menu-path">Polarization</span> submenu allows the selection of different
polarizations for which many data items are calculated (e.g.&nbsp;gain,
F/B ratio etc). The selection is global, e.g.&nbsp;it effects all
relevant data that are drawn or displayed in other windows.
The <span class="menu-path">Common Projection</span> item couples the projection (viewing
angle) parameters of the Structure display in the Main window and
the Gain or E/H field display in the <a href=
"#RadiationWindow">Radiation pattern</a> window so that both move
in step. Similarly, the <span class="menu-path">Common Frequency</span> menu item couples
the Frequency entry/display spin buttons in the same windows so
that displayed data are for the same frequency.</p>
<h3 id="RadiationWindow">The Radiation Pattern window</h3>
<figure>
<img src="images/radiation.png" class="float-left" alt="Radiation pattern window showing 3D gain visualization" loading="lazy">
<figcaption>Radiation pattern window showing 3D gain visualization</figcaption>
</figure>
On
the top row of widgets, this window has the same Viewer angle
selection buttons and spin button displays as the <a href=
"#MainWindow">Main window</a>. The two buttons at the middle right
(<span class="ui-button">Gain</span> (<kbd class="shortcut">g</kbd>) and <span class="ui-button">E/H Field</span> (<kbd class="shortcut">f</kbd>)) select either the Gain
or the Near Electric/Magnetic Field pattern display. Provided there
are at least two steps in the <var>θ</var> and one in the <var>φ</var> angle as
specified in the Radiation Pattern (<code class="nec-card">RP</code>) command, the Gain pattern
will be calculated and drawn. The E/H field will be properly drawn
if there are at least two points specified in the <code class="nec-card">NE</code> or <code class="nec-card">NH</code>
commands. The Frequency Loop control buttons at the far right can
be used to Start, Pause and Reset the loop.</p>
<p>The <span class="ui-button">View</span> menu, in addition to the <span class="menu-path">Common
Projection</span> and <span class="menu-path">Common Frequency</span> check buttons, provides
submenus for selecting <span class="ui-button">Polarization</span> type, <span class="ui-button">Gain
Scaling</span> and the <span class="ui-button">Near Field</span> data to be drawn. The
selection of polarization type affects the Gain pattern, the
displayed Viewer gain and the value of max and min gain as shown to
the left and right of the color code bar. The selection of gain
scaling only affects the form of the Gain pattern drawing:
<span class="ui-button">Linear Power</span> is the most realistic, since the distance from
the origin of each point in the gain pattern is proportional to the
radiated power density, as is the color code (red for max gain and
magenta for min gain). A disadvantage of this scaling is the
inadequate representation of side lobes since they are usually
significantly weaker than the main beam. <span class="ui-button">Linear Voltage</span> is
better in this respect since the position of points in the gain
pattern is proportional to Electric field strength and hence
follows a square root law. <span class="ui-button">ARRL Style</span> follows a form of
logarithmic scaling suggested by the American Radio Relay League,
e.g.&nbsp;<code class="math-expression">exp(0.058267&nbsp;×&nbsp;gain)</code> where gain is in&nbsp;dB<sub>10</sub>. Finally
<span class="ui-button">Logarithmic</span> follows a logarithmic scale with a median of
40&nbsp;dB.</p>
<p>When a Near Field (<code class="nec-card">NE</code> or <code class="nec-card">NH</code>) command is included
in the input file, clicking the <span class="ui-button">E/H Field</span> (<kbd class="shortcut">f</kbd>) button
produces a drawing of the near Electric and/or Magnetic fields. By
selecting the <span class="menu-path">Near Field → Poynting Vector</span> menu item the
Poynting vector is also drawn. These fields are depicted by lines
of fixed length in the direction of the relevant (E/H/Poynting)
vector at each point in the drawing. The field strength is depicted
by the color of the lines as using the line length for this purpose
makes most lines too small to be useful. The drawing of the Near E
or H Fields can be enabled or disabled by the <span class="menu-path">Near Field → Near E Field</span> and <span class="menu-path">Near Field → Near H Field</span>
menu items.</p>
<p>The <span class="menu-path">Near Field → Animate Dialog</span> menu item opens a
dialog box for setting the parameters and starting an Animation of
the near field pattern. The <span class="ui-button">Steps/Cycle</span> spin button allows
the setting of the number of angular steps around a cycle of the
excitation input. The default is 36 and it results in angular steps
of 10°. The <span class="ui-button">Animate Frequency</span> spin button specifies a
fictitious (slowed down) excitation frequency for which the
animation is performed. The default is 1.0&nbsp;Hz. Clicking the
<span class="ui-button">Apply</span> button starts an animation of the near fields using
the specified parameters. The <span class="ui-button">OK</span> button does like wise but
it closes the animation dialog, while <span class="ui-button">Cancel</span> stops the
animation.</p>
<p>The <span class="ui-button">Total Field</span> sub-menu allows the selection of drawing
either the <span class="ui-button">Peak</span> value or a "time-frozen" <span class="ui-button">Snapshot</span> of
the instantaneous value of the total Near Field E/H vectors. The
Snapshot values are calculated as the vector sum of the X, Y, Z
components of the E/H field and the Peak values are calculated
using the formula NEC4 uses to print the Peak field values.</p>
<p>The <span class="menu-path">Overlay Structure</span> menu item enables the drawing of
the structure in the radiation pattern drawing area when the Near
Field pattern is selected for drawing. This makes it easier to
understand the scale and extend of the Near Field patterns around
the structure. The color scheme for the structure becomes white
when Overlay is enabled, unless it is overridden by either the
Current or Charge distribution being enabled by the relevant
buttons in the <a href="#MainWindow">Main window.</a></p>
<p>In the second row of widgets, the <span class="ui-button">Color Code</span> bar shows
either the max and min values of Gain in the radiation pattern or
the maximum value of the field strength in the near E/H field
pattern. (Of course only one value can be shown, the precedence
being E field, H field or Poynting field strength, depending on
which of these is enabled in the <span class="menu-path">View → Near Field</span> sub
menu). The <span class="ui-button">Text Entry</span> widget at the right of the color bar
shows gain in the direction of the viewer (perpendicular to
screen), while the <span class="ui-button">Frequency Spin button</span> following it shows
the current frequency in&nbsp;MHz for which data is displayed. It can
also be used to enter a new frequency in the same manner as in the
<a href="#MainWindow">Main window.</a> The <span class="ui-button">Redo Check box</span>
enables re-calculation and display of data when the frequency value
changes, while the button to its right causes same when clicked by
the user, but only if a new frequency has been entered.</p>
<p>Currently the Gain pattern is drawn as a transparent wire frame,
with each line segment colored according to the average value of
gain associated with the two points it joins. The pattern can be
"dragged" with the mouse pointer to rotate or tilt it and it can
also be positioned using either the <span class="ui-button">X</span> (<kbd class="shortcut">x</kbd>), <span class="ui-button">Y</span> (<kbd class="shortcut">y</kbd>), <span class="ui-button">Z</span> (<kbd class="shortcut">z</kbd>), or
<span class="ui-button">Default</span> (<kbd class="shortcut">d</kbd>) buttons. The <span class="ui-button">Rotate</span> and
<span class="ui-button">Incline</span> spin buttons can also be used to accurately position
the Gain pattern in the window. The <span class="ui-button">label</span> in the drawing
area's frame gives information on what is on display and also the
type of polarization or gain scaling.</p>
<p>Starting with version 2.1, the radiation pattern display can be
zoomed in or out by using the mouse wheel or the Zoom controls
(<span class="ui-button">Zoom %</span> spin wheel and the <span class="ui-button">Zoom In</span> (<kbd class="shortcut">Ctrl+Plus</kbd>), <span class="ui-button">Zoom Out</span> (<kbd class="shortcut">Ctrl+Minus</kbd>),
and <span class="ui-button">Zoom 100%</span> (<kbd class="shortcut">Ctrl+1</kbd>) buttons) and it can also be moved around by
dragging with the right mouse button #2.</p>
<p>Both the Gain and Near Field patterns can be saved as PNG image
files by using the <span class="menu-path">File → Save</span> menu (<kbd class="shortcut">s</kbd>) or <span class="menu-path">File → Save As</span>
menu (<kbd class="shortcut">Ctrl+s</kbd>) items. The Save option will save the drawings
with a suitable default file name which includes a serial number,
so that consecutive Saves do not overwrite files.</p>
<aside class="notice" role="note">
<h4>Note</h4>
<p>When xnec2c is restarted the serial numbers are reset so that
overwriting will occur if the same input file is opened.</p>
</aside>
<p>Starting with <span class="version-tag">v2.1</span>, xnec2c can save the radiation pattern
and near E/H field display as a data file for the <code>gnuplot</code>
plotting program. This is done by using the <span class="menu-path">File → Save As gnuplot</span> menu item, to open a file chooser dialog. If only the
stem of the filename is given, xnec2c will automatically add the
<span class="filepath">.gplot</span> extension. Plotting in gnuplot is done with the <code class="language-gnuplot">splot
&lt;<var>filename</var>&gt; with lines</code> command, although the plot can be
enhanced with some of the style etc commands available in
gnuplot.</p>
<h3 id="FrequencyWindow">Frequency Data Plots window</h3>
<figure>
<img src="images/freq_plots.png" class="float-left" alt="Frequency plots window showing VSWR and gain graphs" loading="lazy">
<figcaption>Frequency plots window showing VSWR and gain graphs</figcaption>
</figure>
<p>
The
Frequency Data Plots window is the main display of frequency
related data such as maximum gain, VSWR, input impedance etc. Most
data can be plotted against frequency and some are displayed in
text entry widgets. It is also a convenient way to quickly enter a
new current frequency by clicking on the graph drawing area.</p>
<p>The following applies to all graphs plotted in this window: When
a graph of two quantities against frequency is plotted (e.g.&nbsp;real
and imaginary parts of input impedance), then one quantity is
plotted in magenta color and its scale is at the left vertical side
of the bounding box. The second quantity is plotted in cyan color
and its scale is at the right side while a short descriptive title
is printed in yellow at the top horizontal side. The graph bounding
box is in white and the scale grid lines are in light gray. When
only a single quantity is plotted against frequency, it is plotted
in magenta color and the scale is at the left side of the bounding
box.</p>
<p>Once graph plotting is complete (e.g.&nbsp;the frequency loop is
done), clicking on the graph drawing area with button #1 (left
mouse button) will produce a vertical green line in the graph
bounding box, marking the new current frequency and triggering a
re-calculation of all frequency-related data. Also, displays and
drawings in all open windows (assuming the Redo check boxes are
ticked active) will be refreshed to present the new data. Clicking
on the drawing area with button 3 (right button) sets the frequency
to the nearest frequency loop step value, as marked by the little
boxes or diamonds on the graphs. However, all the displayed
frequency-related data are still recalculated and refreshed e.g.
buffered values are not used. Clicking with button 2 (middle
button) cancels the green frequency-marking line.</p>
<p>The top row of widgets in this window has at its right buttons
to select data to be plotted against frequency. These are:</p>
<table class="button-table">
<thead>
<tr>
<th>Button</th>
<th>Shortcut</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="ui-button">Max Gain</span></td>
<td><kbd class="shortcut">m</kbd></td>
<td>Maximum gain and front-to-back ratio at each frequency step.</td>
</tr>
<tr>
<td><span class="ui-button">Direction</span></td>
<td><kbd class="shortcut">d</kbd></td>
<td>The direction of maximum gain, e.g.&nbsp;the radiation angle relative to the xy plane (90&nbsp;&minus;&nbsp;<var>θ</var>) and the <var>φ</var> angle as defined in NEC2.</td>
</tr>
<tr>
<td><span class="ui-button">Viewer</span></td>
<td><kbd class="shortcut">w</kbd></td>
<td>The gain in the viewer's direction, e.g. perpendicular to the screen.</td>
</tr>
<tr>
<td><span class="ui-button">VSWR</span></td>
<td><kbd class="shortcut">v</kbd></td>
<td>The VSWR for the Z<sub>0</sub> value in the <span class="ui-button">Impedance Spin button</span> (default 50&nbsp;Ω).</td>
</tr>
<tr>
<td><span class="ui-button">Z<sub>r</sub>/Z<sub>i</sub></span></td>
<td><kbd class="shortcut">z</kbd></td>
<td>The real and imaginary parts of the input impedance.</td>
</tr>
<tr>
<td><span class="ui-button">Z<sub>m</sub>/Z<sub>ph</sub></span></td>
<td><kbd class="shortcut">p</kbd></td>
<td>The scalar magnitude and phase of the input impedance.</td>
</tr>
</tbody>
</table>
<p>The <span class="menu-path">View → Net Gain</span> menu item changes the second plotted
quantity to the Net Gain of the array. Net Gain is the effective
gain after subtracting the effects of reflection caused by
impedance mismatch (return loss); Net Gain is equal to Raw Gain
when VSWR&nbsp;≈&nbsp;1.0 (S<sub>11</sub>&nbsp;≈&nbsp;−∞).</p>
<p>The Frequency Loop control buttons at the top right can be use
to Start, Pause or Reset the loop. As the loop progresses, more
data will be presented in the graphs and in the text entry widgets
above the graph drawing area. These widgets display the current
frequency in&nbsp;MHz, the maximum gain in the radiation pattern for
that frequency, the VSWR for the Z<sub>0</sub> value in the spin button above
and the real and imaginary parts of the input impedance.</p>
<p>The <span class="menu-path">File → Save</span> menu <kbd class="shortcut">s</kbd> and <span class="menu-path">File → Save As</span> menu <kbd class="shortcut">Ctrl+s</kbd> items can be used to save the graphs in the drawing
area as PNG image files, with a default file name or one of the
user's choice respectively. The <span class="menu-path">View → Polarization</span>
submenu can be used to select the wave polarization type for which
data is calculated and presented. When Viewer gain plotting is
enabled, the graph will be re-drawn when the structure projection
is changed by the various means described earlier (dragging by
mouse pointer, Rotate/Incline spin buttons etc).</p>
<p>Starting with <span class="version-tag">v2.1</span>, xnec2c can save the frequency
dependent functions as a data file for the <code>gnuplot</code> plotting
program. This is done by using the <span class="menu-path">File → Save As gnuplot</span>
menu item, to open a file chooser dialog. If only the stem of the
filename is given, xnec2c will automatically add the <span class="filepath">.gplot</span>
extension. Plotting in gnuplot is done with the <code class="language-gnuplot">plot for [i=2:3] 'filename.gplot' using 1:i with lines smooth bezier title columnhead(i)</code>
command at the gnuplot console, although the plot can be enhanced with
some of the style etc commands available in gnuplot. In this example
it plots columns 2 and 3 (zreal and zimag) against column 1 (MHz).
Change 2:3 to 2:16 to see all columns, though 16 plots will make the
graph very busy.</p>

<h4>Touchstone Files</h4>
<p>
Touchstone files (or SnP files) are used by professional RF software
packages like Microwave Office, Sonnet, and others.   Now xnec2c can
export <span class="filepath">.s1p</span> and <span class="filepath">.s2p</span> files to be used with those software packages.
S<sub>11</sub> is the same as return loss, reflection and <span class="filepath">.s1p</span> files provide
single-port data.  You can export Touchstone files from the Frequency
Plots with <span class="menu-path">File → Save as Touchstone (.SnP)</span>.
</p>

<p>
For <span class="filepath">.s2p</span> files gain is used as S<sub>21</sub> and S<sub>12</sub>: we assume the antenna is
passive so <code>S<sub>21</sub>&nbsp;==&nbsp;S<sub>12</sub></code>.  S<sub>22</sub> is a bit of a mystery, so we assume
that all S<sub>22</sub> behavior is normalized into S<sub>11</sub> and thus S<sub>22</sub> is deminimus
and set it to −100&nbsp;dB.  This may not be a correct assumption, so please
provide a suggestion here if you know a better way.
</p>
<p>
The S<sub>21</sub> and S<sub>12</sub> values in the <span class="filepath">.s2p</span> come in two types: Max Gain and
Viewer Gain.  Max gain is the maximum gain of the antenna, whereas,
viewer gain is the current gain of the antenna pointing toward the
viewport of xnec2c.  For a directional antenna, pointing the main antenna
lobe toward the xnec2c viewport would give the same (or nearly the same)
values as max gain.
</p>
<p>
Once you have your <span class="filepath">.s2p</span> or <span class="filepath">.s1p</span> files you can design a matching circuit
or other RF behavior in your favorite RF design software.
</p>

</p>
<h3 id="Nec2Treeview">NEC2 Input File Editor</h3>
<figure>
<img src="images/nec2_edit.png" class="float-left" alt="NEC2 input file editor window" loading="lazy">
<figcaption>NEC2 input file editor window</figcaption>
</figure>
<p>
Xnec2c has
a built-in NEC2 input file editor to make the edit/save/execute
cycle easier and quicker. The main editor window opens from either
the <span class="menu-path">File → New</span> menu <kbd class="shortcut">n</kbd> or <span class="menu-path">File → Edit</span> menu <kbd class="shortcut">e</kbd> items of the
<a href="#MainWindow">Main window</a>. The <span class="menu-path">File → New</span> menu
item opens the editor with some default rows ("cards") that amount
to a free space vertical dipole which serves as a simple example.
The <span class="menu-path">File → Edit</span> menu is used to edit a NEC2 input file
that is already open in xnec2c.</p>
<p>The main NEC2 input file editor can be used to directly edit
rows if desired and indeed this is the only method available for
editing Comments. The editor though has several dedicated
sub-editors for each of the type of card that is indicated in the
Buttons above the Geometry and Commands Tree Views. The dedicated
editor windows open when these buttons are clicked (to add a new
row) or when a selected row is right-clicked by the user with the
mouse.</p>
<h4>Main Editor Description</h4>
<p>The Main NEC2 Editor window is divided into three Tree View areas,
one for editing Comments, one for editing Geometry and one for
Control Commands. Each tree view has editable rows divided into
cells that correspond to NEC2 input file's card columns e.g.&nbsp;Card
Name (<code class="nec-card">CM</code>) - Comment Text or Card Name (<code class="nec-card">GW</code>) - Wire Data (<var>I1</var> <var>I2</var> <var>F1</var> <var>F2</var>
<var>F3</var> <var>F4</var> <var>F5</var> <var>F6</var> <var>F7</var>) etc. Each row can be edited by selecting it with a
mouse click and then clicking on a cell. This requires detailed
knowledge of the format of each of the NEC2 input file "cards" and
so this method is only useful for editing comments.</p>
<p>The main editor is controlled by the top row of buttons: The
<span class="ui-button">Add</span> (<kbd class="shortcut">Ctrl+a</kbd>) button inserts a new blank row in whatever tree
view has been selected by a mouse click. The <span class="ui-button">Remove</span> (<kbd class="shortcut">Ctrl+r</kbd>)
button deletes a row that was selected by a mouse click and the
<span class="ui-button">Clear</span> (<kbd class="shortcut">c</kbd>) button deletes all rows in a selected tree view
and clears it. The <span class="ui-button">Save As</span> (<kbd class="shortcut">Ctrl+Shift+s</kbd>) button opens a file
selector dialog for saving the data in the Editor to a NEC2 input
file. The <span class="ui-button">Save</span> (<kbd class="shortcut">Ctrl+s</kbd>) button writes data in the Editor to
an already open input file. The <span class="ui-button">Apply</span> check button, when checked,
signals xnec2c to reload the edited input file for execution.</p>
<p>Note: In xnec2c versions earlier than <span class="version-tag">v2.0-beta</span>, due to
the complex file opening process followed by NEC2 (many data sanity
checks and initializations etc), reloading the input file resulted
in all open windows (radiation pattern, frequency plots) to be
closed. This was always an awkward situation and slowed down work
in the NEC2 input file editor. As of xnec2c <span class="version-tag">v2.0-beta</span>, the
user interface as well as a fair amount of code in xnec2c, have
been modified so that as far as possible, when an edited NEC2 file
is saved and reloaded, or another NEC2 file is opened, xnec2c will
not close open Radiation Pattern or Frequency Plot windows and will
not completely reset internally. This allows the user to edit a
NEC2 file in the Editor window and, after saving, to be presented
with the new calculations on the structure being modeled.</p>
<p>Finally the <span class="ui-button">Revert</span> (<kbd class="shortcut">Ctrl+r</kbd>) button reloads the last saved
state of the editor from the input file, to reduce the effort
needed to recover from a big mistake like clearing a tree view
accidentally!</p>
<h4>Sample Dedicated Geometry Editor Description</h4>
<figure>
<img src="images/wire.png" class="float-left" alt="Wire geometry editor dialog" loading="lazy">
<figcaption>Wire geometry editor dialog</figcaption>
</figure>
<h4>Wire Geometry Editor</h4>
This is one of the dedicated "card" or row
editors, for creating or editing wire geometry. It will appear when
the "Wire" button in the "Edit Geometry Data" frame is clicked or
when a selected Wire row is right-clicked with the mouse. In the
former case, a blank <code class="nec-card">GW</code> row will be added to the Geometry tree
view which can then be filled by entering wire geometry data in the
Editor and clicking Apply or OK. (in the latter case the editor is
closed). The "Tapered Wire" check button in the upper left corner
opens an additional frame for entering wire taper data and adds a
blank <code class="nec-card">GC</code> row to the tree view.</p>
<p>To make things easier, the Wire editor has spin buttons to
specify Length Taper and Diameter Taper separately to hide the need
for calculating the actual beginning and end diameters. Also the
"Segs&nbsp;%&nbsp;<var>λ</var>" spin button indicates the wire segment length as a
percentage of smallest <var>λ</var> and can be use to set the needed
number of segments for each wire to maintain a uniform relative
segment length for all wires.</p>
<aside class="notice" role="note">
<h4>Note</h4>
<p>This function
will only work if the Frequency (<code class="nec-card">FR</code>) card is specified in the
Commands tree view <i>and</i> all the data is saved to file and
read by xnec2c, so that frequency data is valid in xnec2c's
buffers.</p>
<p>All dedicated editors require
wire diameter to be specified but then convert this to radius when
entering to the Main editor and saving to file (NEC2 requires wire
radius to be specified).</p>
</aside>
<p>Three geometry Editors (wire, helix, arc) have a spin button to
specify wire conductivity in S/m. When the spin button
value is greater than zero, the Editor will enter an <code class="nec-card">LD</code> card in the
Commands tree view to specify a type 5 (wire conductivity) loading.
This will result in all segments with tag number equal to that in
the Editor to be loaded with the specified resistivity.</p>
<aside class="notice" role="note">
<h4>Note</h4>
<p>Deleting the <code class="nec-card">GW</code> row in the Geometry tree view will not remove
the <code class="nec-card">LD</code> loading row in the Commands tree view.</p>
</aside>
<p>All editors (except for the <code class="nec-card">GE</code> card) have the following
buttons along the bottom of the window: "New" inserts a new blank
row in the tree view after entering edited data into the current
row. "Delete Card" removes the current row (card) and closes the
editor window. "Apply" enters edited data into the current row.
"OK" enters edited data into the current row and closes the editor
window.</p>
<aside class="notice" role="note">
<h4>Note</h4>
<p>The <code class="nec-card">GE</code> row is entered
automatically by the first editor used, if the tree view is
cleared, and there is no button for it in the Geometry frame. But
there is a dedicated editor for it which opens with a right-click
on the (selected) <code class="nec-card">GE</code> row and <i>it should be used</i> to specify
the presence of Ground (<code class="nec-card">GN</code> command etc).</p>
</aside>
<p>As of <span class="version-tag">v3.9-beta</span>, the <code class="nec-card">GH</code> "card" editor has a new
appearance, since the Helix producing code has been edited to allow
the creation of a spiral. Both right-hand/left-hand helices or
spirals can be specified with the radio buttons in the top row of
the <code class="nec-card">GH</code> editor dialog. In the bottom row, the radii that specify the
shape of helices or spirals can be entered in the relevant spin
buttons. These can be linked so that values entered can be
propagated to the right, to make editing easier if all radii are
the same. Right propagation is controlled by clicking on the "chain
link" icons - if the icon displays a linked chain, right
propagation is enabled. Otherwise if a broken link, right
propagation is disabled.</p>
<h4>Sample Dedicated Control Editor</h4>
<figure>
<img src="images/excitation.png" class="float-left" alt="Excitation command editor dialog" loading="lazy">
<figcaption>Excitation command editor dialog</figcaption>
</figure>
<h4>Excitation Command Editor</h4>
The Excitation Command
Editor opens when the "Excitation" button in the "Edit Control
Commands" frame is clicked or when a selected <code class="nec-card">EX</code> row is
right-clicked with the mouse. The excitation type is selected by
activating the appropriate radio button whereby some labels over
the data input spin buttons will change to indicate their purpose.
The print control check buttons specify additional data to be
printed to the output file but please remember that xnec2c does not
produce an output file. The buttons in the bottom row of the
Command Editors function in the same way as the Wire editor
described above.</p>

<h3 id="Optimization">Antenna Geometry Optimization</h3>

<p>
Neoklis, 5B4AZ explains Antenna Optimization in xnec2c on his page <a target="_blank" rel="noopener noreferrer"
href="https://www.5b4az.org/pages/antenna_designs.html">here</a> as follows:</p>

<blockquote>
<p>Xnec2c monitors its <span class="filepath">.nec</span> input file for changes and re-runs the frequency
stepping loop which recalculates new data and prints to the <span class="filepath">.csv</span> file. It is
therefore possible to arrange the optimizer program to read the <span class="filepath">.csv</span> data file,
recalculate antenna parameters and save them to the <span class="filepath">.nec</span> input file. xnec2c
will then recalculate and save new frequency-dependent data to the <span class="filepath">.csv</span> file.</p>

<p>If the optimizer program is arranged to monitor changes to the <span class="filepath">.csv</span> file, then
a continuous loop can be created in which new antenna parameters are calculated
and saved to the <span class="filepath">.nec</span> file, new frequency dependent data are calculated and
saved to the <span class="filepath">.csv</span> file and the loop repeated until the desired results
(optimization) are obtained.</p>

<footer><cite>Neoklis, 5B4AZ</cite></footer>
</blockquote>

<p>
This optimization feedback mechanism was first implemented in Xnec2c <span class="version-tag">v4.2</span> and
has been refined over the past couple of versions to be very effective at
optimizing antenna geometry.
</p>

<h3 id="Optimizers">External Optimizers</h3>

<p>
As explained above, you need to use an external optimizer to optimize with
xnec2c.  The following external optimization packages are available.  Click one
of the packages for more information:
</p>

<ul>
	<li>
		<strong><a target="_blank" rel="noopener noreferrer" href="https://github.com/polyrod/xnec2c-gao/">Xnec2c-gao</a></strong>
		is an external optimizer that uses a genetic algorithm to find
		solutions in a multidimensional search space.  It is written in Haskell
		by Maurizio Di Pietro, <span class="callsign">DC1MDP</span> and hosted on github.
	</li>
	<li>
		<strong><a target="_blank" rel="noopener noreferrer" href="https://github.com/KJ7LNW/xnec2c-optimize/">Xnec2c-optimize</a></strong>
		is written in Perl by Eric, <span class="callsign">KJ7LNW</span> and hosted on github.</li>
	</ul>

<h4>Activating <span class="filepath">.NEC</span> File Monitoring for Optimization</h4>

<p>
Xnec2c will monitor the currently open <span class="filepath">.NEC</span> file when you select
<span class="menu-path">File → Optimization Settings</span> and select "Reload and write data on <span class="filepath">.NEC</span> file
changes".  Additionally, you need to tell xnec2c where to write its output
file.  You can do that with one of the <code>--write-*</code> command-line options
or by checking one of the boxes in <span class="menu-path">File → Optimization Settings</span> such as
"After calculation, write &lt;file&gt;<span class="filepath">.csv</span>".</p>

<p>
Finally you need to enable the frequency sweep if it is not already turned on as follows:
<ol>
<li>From the main window: select <span class="menu-path">View → Frequency Plots</span></li>
<li>From the Frequency Data Plots window: Enable a graph, like VSWR. Configure
	whatever you would like to see during optimization.  </li>
<li>Click the triangular "Play" button to run a frequency sweep.  This is a
persistent setting that will auto-sweep each time xnec2c loads and it must be
active in order for the optimizer loop to function.</li>
</ol>

<p>
Frequency loop timing information is available on the console when you increase
verbosity with <code>-v</code>.  Specify  <code>-v</code> multiple times to increase
verbosity.  For example, with <code>-vv</code> using <span class="filepath">examples/2m_yagi.nec</span>:

<pre><code class="language-bash">[info] 140.000000&nbsp;MHz: 0.045850 seconds. (ATLAS, Threaded)
[info] 141.500000&nbsp;MHz: 0.054378 seconds. (ATLAS, Threaded)
[info] 140.000000&nbsp;MHz: 0.063772 seconds. (ATLAS, Threaded)
[info] 140.500000&nbsp;MHz: 0.066472 seconds. (ATLAS, Threaded)
[info] 141.000000&nbsp;MHz: 0.078861 seconds. (ATLAS, Threaded)
[info] 142.000000&nbsp;MHz: 0.047910 seconds. (ATLAS, Threaded)
[info] 143.000000&nbsp;MHz: 0.068066 seconds. (ATLAS, Threaded)
[info] 143.500000&nbsp;MHz: 0.076449 seconds. (ATLAS, Threaded)
[info] 144.000000&nbsp;MHz: 0.068083 seconds. (ATLAS, Threaded)
[info] 142.500000&nbsp;MHz: 0.113185 seconds. (ATLAS, Threaded)
[info] 146.000000&nbsp;MHz: 0.050178 seconds. (ATLAS, Threaded)
[info] 144.500000&nbsp;MHz: 0.051486 seconds. (ATLAS, Threaded)
[info] 145.000000&nbsp;MHz: 0.058897 seconds. (ATLAS, Threaded)
[info] 145.500000&nbsp;MHz: 0.060019 seconds. (ATLAS, Threaded)
[info] 147.000000&nbsp;MHz: 0.057313 seconds. (ATLAS, Threaded)
[info] 146.500000&nbsp;MHz: 0.070968 seconds. (ATLAS, Threaded)
[info] 148.000000&nbsp;MHz: 0.071760 seconds. (ATLAS, Threaded)
[info] 147.500000&nbsp;MHz: 0.080575 seconds. (ATLAS, Threaded)
[info] 148.500000&nbsp;MHz: 0.051870 seconds. (ATLAS, Threaded)
[info] 149.500000&nbsp;MHz: 0.058890 seconds. (ATLAS, Threaded)
[info] 150.000000&nbsp;MHz: 0.056449 seconds. (ATLAS, Threaded)
[info] 149.000000&nbsp;MHz: 0.071011 seconds. (ATLAS, Threaded)
[notice] Frequency loop elapsed time: 0.467847 seconds. (ATLAS, Threaded)
</code></pre>

</p>

<h2 id="InputFile">Input File Considerations</h2>
<p>
Since xnec2c is interactive, it will not initiate calculations
without a prompt from the user. For this reason certain NEC2
commands that normally cause execution (e.g.&nbsp;<code class="nec-card">RP</code>, <code class="nec-card">XQ</code> etc) are read
in but not acted upon. Any data in the lines of these commands are
saved for use when the user requests output data calculation and
display, via buttons and menu items in the GUI. Also, since xnec2c
was designed to visualize output data graphically, certain types of
output data requests are not supported (e.g.&nbsp;the surface wave
pattern option (<var>I1</var> = 1) of the <code class="nec-card">RP</code> command etc). An error message
dialog will hopefully appear to inform the user of unsupported
commands or options.
</p>

<p>Since xnec2c is an implementation of NEC2.  You can learn more about the NEC2
format at <a target="_blank" rel="noopener noreferrer" href="https://www.nec2.org">https://www.nec2.org</a>. Be sure to review
<a target="_blank" rel="noopener noreferrer" href="https://www.nec2.org/part_3/toc.html">Part III: NEC User's Guide</a>.

Here is a list of commands or command options not supported by xnec2c:

</p>
<dl>
<dt><code class="nec-card">GF</code></dt>
<dd>Read Numerical Green's Function: Relevant code has been removed in nec2c since this type of solution is obsolete.</dd>

<dt><code class="nec-card">WG</code></dt>
<dd>Write Numerical Green's Function: Relevant code has been removed in nec2c since this type of solution is obsolete.</dd>

<dt><code class="nec-card">NX</code></dt>
<dd>Next Structure Data: Relevant code has been removed since xnec2c cannot operate in batch mode.</dd>

<dt><code class="nec-card">PQ</code>, <code class="nec-card">PT</code>, <code class="nec-card">CP</code></dt>
<dd>These commands affect printed output and have no effect on data presented by xnec2c in graphical form. Since <span class="version-tag">v1.0</span> xnec2c does not print results to file.</dd>

<dt><code class="nec-card">SOMNEC</code></dt>
<dd>The separate SOMNEC code has been incorporated in nec2c and hence in xnec2c also.</dd>

<dt><code class="nec-card">EX</code></dt>
<dd>When Incident Wave or Elementary Current Source Excitation is specified, xnec2c can only calculate and render the re-radiated field, produced by the current induced onto the structure. Only the initial values of the <var>θ</var> and <var>φ</var> angles are used and no stepping of these angles is performed. Therefore it is better to specify only one step for <var>θ</var> and <var>φ</var> in the <code class="nec-card">EX</code> card.</dd>

<dt><code class="nec-card">RP</code></dt>
<dd>The surface wave option (<var>I1</var> = 1) is not supported.</dd>

<dt><code class="nec-card">ZO</code></dt>
<dd>As of <span class="version-tag">v3.7-beta</span>, this is a new "card" addition to the input file, which I have incorporated to allow the Transmission Line Z<sub>0</sub> to be specified in the NEC2 antenna description file.</dd>
</dl>
<h2 id="OutputFile">Output File Considerations</h2>
<p>
Printing of results to an output file has been removed starting
from <span class="version-tag">v1.0</span>, since xnec2c works in a way that does not allow
printing compatible with the NEC2 format. If printing to file is
needed then it is better to use the original NEC2 program, to avoid
bugs that may still be lurking in the C translation.</p>
<h2 id="Version">Version History (newest first)</h2>

<h3>Version <span class="version-tag">4.4.18</span></h3>
<p>This release focuses on mathlib enhancements, platform compatibility improvements for MacOS and Fedora, and crash prevention through input validation.

<ul>
	<li>Contributors:
		<ul>
			<li><span class="github-user">@vk1kcm</span> - MacOS testing, reported <a href="https://github.com/KJ7LNW/xnec2c/issues/73" target="_blank" rel="noopener noreferrer">#73</a>, tested MacOS build (<a href="https://github.com/KJ7LNW/xnec2c/issues/66" target="_blank" rel="noopener noreferrer">#66</a>)</li>
			<li><span class="github-user">@likecabezon</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/70" target="_blank" rel="noopener noreferrer">#70</a></li>
			<li>Richard Shaw - reported Fedora OpenMP build issue</li>
		</ul>
	</li>

	<li>Features:
		<ul>
			<li>Thread count control via CLI options (<code>--openblas-threads</code>, <code>--mkl-threads</code>, <code>--omp-threads</code>)</li>
			<li>MacOS MacPorts OpenBLAS support</li>
			<li>Mathlib ID-based configuration for stable config persistence across version upgrades</li>
		</ul>
	</li>
	<li>Bug Fixes:
		<ul>
			<li>Fix mathlib benchmark crash without loaded NEC2 file (<a href="https://github.com/KJ7LNW/xnec2c/issues/73" target="_blank" rel="noopener noreferrer">#73</a>)</li>
			<li>Fix OpenMP linking in Fedora RPM builds</li>
			<li>Fix strict-prototypes warning on macOS builds (<a href="https://github.com/KJ7LNW/xnec2c/issues/66" target="_blank" rel="noopener noreferrer">#66</a>)</li>
			<li>Fix nearfield animation crash with missing NE/NH cards (<a href="https://github.com/KJ7LNW/xnec2c/issues/70" target="_blank" rel="noopener noreferrer">#70</a>)</li>
		</ul>
	</li>
	<li>Documentation:
		<ul>
			<li>Thread control options documented in man page and HTML documentation</li>
		</ul>
	</li>
	<li>Build system:
		<ul>
			<li>Fix CFLAGS handling in spec file to preserve OpenMP flags</li>
		</ul>
	</li>
</ul>
</p>

<h3>Version <span class="version-tag">4.4.17</span></h3>
<p>This release includes radiation pattern color legend enhancements, critical bug fixes for locale handling and CSV output, stability improvements, and build system updates.

<ul>
	<li>Contributors:
		<ul>
			<li>Ian <span class="callsign">G4IXT</span> (<span class="github-user">@g4ixt</span>) - color legend suggestions, reported <a href="https://github.com/KJ7LNW/xnec2c/issues/61" target="_blank" rel="noopener noreferrer">#61</a></li>
			<li>Neoklis <span class="callsign">5B4AZ</span> (<span class="github-user">@neoklis</span>) - technical guidance on current scaling (<a href="https://github.com/KJ7LNW/xnec2c/issues/61" target="_blank" rel="noopener noreferrer">#61</a>)</li>
			<li>Devin Bayer (<span class="github-user">@akvadrako</span>) - fixed double-free crash in geometry editor (<a href="https://github.com/KJ7LNW/xnec2c/pull/67" target="_blank" rel="noopener noreferrer">#67</a>)</li>
			<li><span class="github-user">@hamarituc</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/59" target="_blank" rel="noopener noreferrer">#59</a></li>
			<li><span class="github-user">@ProtonTheFox</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/44" target="_blank" rel="noopener noreferrer">#44</a>, <a href="https://github.com/KJ7LNW/xnec2c/issues/45" target="_blank" rel="noopener noreferrer">#45</a></li>
			<li><span class="github-user">@likecabezon</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/68" target="_blank" rel="noopener noreferrer">#68</a></li>
			<li>Jerry <span class="callsign">KF7RCC</span> (<span class="github-user">@jerryd</span>) - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/52" target="_blank" rel="noopener noreferrer">#52</a></li>
			<li><span class="github-user">@polprog</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/50" target="_blank" rel="noopener noreferrer">#50</a></li>
			<li><span class="github-user">@roberthadow</span> - reported <a href="https://github.com/KJ7LNW/xnec2c/issues/47" target="_blank" rel="noopener noreferrer">#47</a></li>
		</ul>
	</li>

	<li>Features:
		<ul>
			<li>Graduated color legend with relative/absolute gain marks (-3dB, -6dB, -10dB intervals)</li>
			<li>Color legend with dynamic spacing and proper gain scaling</li>
			<li>Increased 3D zoom limit to 999999x</li>
			<li>GTK menu tear-offs for frequently used menus</li>
			<li>"Begin Frequency Loop at Startup" config checkbox (<a href="https://github.com/KJ7LNW/xnec2c/issues/45" target="_blank" rel="noopener noreferrer">#45</a>)</li>
			<li>Smooth pan/tilt/zoom during optimization</li>
			<li>Responsive mobile support for HTML documentation</li>
		</ul>
	</li>
	<li>Bug Fixes:
		<ul>
			<li>Fix NEC file format to use decimal points regardless of locale (<a href="https://github.com/KJ7LNW/xnec2c/issues/59" target="_blank" rel="noopener noreferrer">#59</a>)</li>
			<li>Fix CSV output scaling for currents/charges magnitude (<a href="https://github.com/KJ7LNW/xnec2c/issues/61" target="_blank" rel="noopener noreferrer">#61</a>)</li>
			<li>Fix double-free crash when editing geometry (<a href="https://github.com/KJ7LNW/xnec2c/pull/67" target="_blank" rel="noopener noreferrer">#67</a>)</li>
			<li>Prevent deadlocks in <code class="language-c">Notice()</code>, <code class="language-c">Open_Input_File()</code>, and dialog scenarios</li>
			<li>Fix endless loop with overlapping segments</li>
			<li>Fix gain value display and color mapping</li>
			<li>Improve error messages for segment tag lookup failures (<a href="https://github.com/KJ7LNW/xnec2c/issues/68" target="_blank" rel="noopener noreferrer">#68</a>, <a href="https://github.com/KJ7LNW/xnec2c/issues/47" target="_blank" rel="noopener noreferrer">#47</a>)</li>
			<li>Fix custom frequency step in color legend</li>
			<li>Fix radiation pattern color legend to match gain scaling styles</li>
			<li>Prevent GTK beeps (<a href="https://github.com/KJ7LNW/xnec2c/issues/50" target="_blank" rel="noopener noreferrer">#50</a>)</li>
			<li>Fix batch mode auto-start (<a href="https://github.com/KJ7LNW/xnec2c/issues/44" target="_blank" rel="noopener noreferrer">#44</a>)</li>
			<li>Graceful child process exit handling</li>
			<li>Reduce severity of math library detection failures to warnings</li>
		</ul>
	</li>
	<li>Documentation:
		<ul>
			<li>Add nec2.org user manual reference (<a href="https://github.com/KJ7LNW/xnec2c/issues/52" target="_blank" rel="noopener noreferrer">#52</a>)</li>
			<li>Update Ubuntu/Debian package suggestions (<a href="https://github.com/KJ7LNW/xnec2c/issues/46" target="_blank" rel="noopener noreferrer">#46</a>)</li>
			<li>Modernize HTML documentation with improved styling</li>
		</ul>
	</li>
	<li>Build system:
		<ul>
			<li>Add VSCode integration with debug configs and auto-configure</li>
			<li>Generate <span class="filepath">c_cpp_properties.json</span> from configure</li>
			<li>Parallel build tasks support</li>
		</ul>
	</li>
</ul>
</p>

<h3>Version <span class="version-tag">4.4.16</span></h3>
<ul>
<li>Bug Fixes:
	<ul>
	<li>Fixed geometry calculations when reading NEC2 decks that use the <code class="nec-card">GM</code> card with <code>tag=0</code> to copy all segments</li>
	<li>Fixed segment lookup failures when <code>tag=0</code> is specified</li>
	<li>Improved error message to properly identify which <code class="nec-card">GM</code> card caused lookup failures</li>
	<li>Improved radiation pattern color legend spacing</li>
	<li>Fixed building on sparc64</li>
	</ul>
</li>
<li>Code cleanups and improvements</li>
<li>Contributors:
	<ul>
	<li>Diane Bruce - inspired code cleanup and helped with pull requests</li>
	<li>Dave Hibberd (<span class="github-user">@Hibby</span>) - Debian maintainer who helped troubleshoot and provide guidance in solving the sparc64 build issue</li>
	</ul>
</li>
</ul>

<h3>Version <span class="version-tag">4.4.15</span></h3>
<p>This release fixes a crash related to a GTK icon problem.
Thanks to <span class="github-user">@AsciiWolf</span> for helping report and troubleshoot the issue.
</p>

<h3>Version <span class="version-tag">4.4.14</span></h3>
<p>This release fixes a hang when the frequency plots window is too small
for the number of plots being rendered.  Thanks to Tom <span class="callsign">DL1JBE</span> who reported
the issue.
</p>

<h3>Version <span class="version-tag">4.4.13</span></h3>
<p>This is a large bug-fix release and includes a few minor features and
documentation updates. I would like to thank the following who helped with new
features and bug fixes, in order of contribution:

<ul>
	<li>Contributors:
		<ul>
			<li>Neoklis <span class="callsign">5B4AZ</span></li>
			<li>Rafal Lukawiecki <span class="callsign">EI6LA</span></li>
			<li><span class="github-user">@ndim</span></li>
			<li><span class="github-user">@anoduck</span></li>
			<li><span class="github-user">@rklasen</span></li>
			<li>Ward, <span class="callsign">AE6TY</span></li>
			<li><span class="github-user">@ChrisMaple</span></li>
		</ul>
	</li>

	<li>Features:
		<ul>
			<li>Save window positions when they are closed</li>
			<li>Tile rdpattern and freqplot windows on first run</li>
			<li>Default the Radiation Pattern "Gain Pattern" to be enabled</li>
			<li>Officially support OpenBSD, thanks <span class="github-user">@anoduck</span> for testing</li>
			<li>Add save radiation pattern to CSV</li>
			<li>Add save currents and charges to CSV</li>
		</ul>
	</li>
	<li>Documentation:
		<ul>
			<li>Added External Optimizers section</li>
			<li>Added Google Translate javascript for the website</li>
		</ul>
	</li>
	<li>Bug Fixes:
		<ul>
			<li>Fixed deadlock when the frequency loop is running and a window is</li>
			  closed. Thanks to Neoklis <span class="callsign">5B4AZ</span> for discovering the problem and proposing</li>
			  a solution.</li>
			<li>Fixed edge case where structure window does not redraw on save. Thanks</li>
			  to Neoklis <span class="callsign">5B4AZ</span> for discovering the problem and providing a fix.</li>
			<li>Fix blank plots, structures and radiation pattern when Quit is pressed.</li>
			<li>Open the Frequency Plots window when Optimization is enabled</li>
			<li>Auto-run freq loop when optimization is enabled</li>
			<li>Differentiate between windows at 0,0 and never opened</li>
			<li>Correct a relatively trivial warning from Coverity Scan about an</li>
			  unused value</li>
			<li>Fix warning from Coverity Scan about invalid argument to a function</li>
			<li>Fix a warning by Coverity Scan about an unterminated buffer</li>
			<li>Fix Coverity Scan warning about a tainted value used in <code class="language-c">malloc()</code></li>
			<li>Fix a Coverity Scan report about a "Forward NULL"</li>
			<li>Convert double-locking synchronization to use a condition</li>
			  variable. Thanks to <span class="github-user">@anoduck</span> for testing and reporting the issue in the</li>
			  process of adding OpenBSD support.</li>
			<li>Fix warning: while loop has empty body</li>
			<li>Fix real/imag swap</li>
			<li>rdpat csv: reset <var>φ</var> on each frequency iteration</li>
			<li>fix integer overflow in frequency selection, thanks to <span class="github-user">@rklasen</span>.</li>
			<li>Fix sommerfeld ground excitement issue. Thanks to Ward, <span class="callsign">AE6TY</span> for</li>
			  reporting the bug and writing a fix.</li>
			<li>Fix off-by-one array index</li>
			<li>Fix sprintf truncation when plotting. Thanks to <span class="github-user">@ChrisMaple</span> for</li>
			  reporting this issue.</li>
			<li>Delay clicked frequency calculation while a freq loop is running</li>
			<li>Fix beeps on GTK field overflow</li>
		</ul>
	</li>
	<li>Build system:
		<ul>
			<li>Huge autoconf and buildsystem refactor by <span class="github-user">@ndim</span></li>
			<li>Updated autoconf to detect Mac OS X properly</li>
			<li>Fix Debian Lintian desktop-mime-but-no-exec-code</li>
			<li>Removed more LMID references</li>
			<li>Changed host_os is not supported to be a warning</li>
			<li>Actually check if backtrace exists.</li>
			<li>Add g_module_supported detection</li>
			<li>Added OARS metadata into AppStream</li>
			<li>Updated autoconf to detect Mac OS X and set LDFLAGS
			accordingly. Big thanks to Rafal Lukawiecki <span class="callsign">EI6LA</span> for helping
			troubleshoot and get xnec2c building on OSX.</li>
		</ul>
	</li>
</ul>
</p>

<h3>Version <span class="version-tag">4.4.12</span></h3>
<p>This release has been pending for a while, there are quite a few changes.
I thought about making this 4.5 but not yet since these are mostly
maintenance items, with a few new features as well:
<ul>
<li>UI Features:
	<ul>
	<li>Added <span class="menu-path">File → Save-as CSV</span> in the Frequency Plots window</li>
	<li>Added optimizer output config checkboxes for csv, s1p, and/or s2p.  Now you can auto-generate <span class="filepath">.csv</span>, <span class="filepath">.s1p</span>, or <span class="filepath">.s2p</span> files when the input <span class="filepath">.nec</span> file is modified by an external program.</li>
	<li>Pre-processed CSV data for each example <span class="filepath">.nec</span> file and placed them in <span class="filepath">examples/data/</span>.  You can view these with any spreadsheet program and graph columns as you like; the data is useful for regression testing, too.</li>
	<li>Updated optimization documentation.</li>
	</ul>
</li>
<li>Console Features:
	<ul>
	<li>Refactored console output based on output priority levels.  Console output is now color coded and output level can be controlled with <code>-v</code> and <code>-d</code> options.  See <code>--help</code> for details.</li>
	<li>Add batch mode (<code>-b</code>) commandline flag.</li>
	<li>Added commandline options <code>--write-csv</code>, <code>--write-s1p</code>, <code>--write-s2p-max-gain</code>, and <code>--write-s2p-viewer-gain</code> for use with <code>--batch</code> and the optimizer.</li>
	<li>Added <code>--optimize</code> to activate the optimizer thread immediately.</li>
	<li>Updated the man page</li>
	</ul>
</li>
<li>Bugfixes:
	<ul>
	<li>Fixed octal representation of <code>0755</code> when creating <span class="filepath">~/.xnec2c/</span></li>
	<li>Added directory permission hotfix for users affected by <span class="commit-hash">4e62893b</span></li>
	<li>Do not invalidate current data when radiation pattern is enabled; Thanks to Gian Luigi for reporting this bug and providing <span class="filepath">.nec</span> file samples to reproduce the problem.</li>
	<li>Check if radiation pattern was calculated before using the <code class="nec-card">RP</code> data,  Thanks to Gian Luigi for reporting this bug, too.</li>
	<li>Added fallback PATH_MAX if undefined, like for GNU/Hurd.</li>
	<li>optimizer: prevent loading zero-byte files</li>
	<li>Disable optimizer if inotify is missing, this should fix xnec2c builds on BSD.</li>
	<li>Fixed printf <code>size_t</code> warnings on 32-bit architectures</li>
	<li>Fix type errors with <code>glib 2.73</code> and later, Thanks to the Debian maintainer Christoph Berg, <span class="callsign">DF7CB</span>, for his work to troubleshot and test this!</li>
	<li>Fixed segfault when mathlib_idx or mathlib_batch_idx is out of range. Thanks to Christoph Berg, <span class="callsign">DF7CB</span> for reporting this.</li>
	<li>Only write optimizer data if FREQ_LOOP_DONE</li>
	<li>Updated <span class="filepath">xnec2c.spec</span> to reference the right dependencies in el8.</li>
	</ul>
</li>
<li>Cleanup:
	<ul>
	<li>Renamed files with a : in them so checkouts will work in Windows.</li>
	<li>Updated frequency calculation timing output.</li>
	<li>mathlib: fixed duplicate BLAS detection, removed LMID support, simplified console output</li>
	<li>Several spelling fixes, thanks to Daniele Forsi, <span class="callsign">IU5HKX</span> (<span class="github-user">@dforsi</span> on github)!</li>
	<li>Fix cross compilation issues, Thanks Michal Vasilek!</li>
	<li>Updated quickstart documentation</li>
	<li>Removed LMID checks from <span class="filepath">configure.ac</span>; again, Thanks Michal Vasilek!</li>
	<li>Re-ordered change history in this document so the newest versions are on top</li>
	</ul>
</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.11</span></h3>
<p>There are many small improvements in this update, please update!  Here is 
a brief summary, see the git commit log for detail:
<ul>
<li>Updated icons and file associations so you can double-click to open
<span class="filepath">.nec</span> files in most desktop environments.  Just <code>make desktop-install</code>
after <code>make install</code> to set it up!  Distribution maintainers: see the
<span class="filepath">PACKAGING</span> file for details.</li>
<li>Added <span class="filepath">.so.0</span> filenames names for OpenBLAS detection in CentOS when
the <code>-devel</code> package is not installed.</li>
<li>Added the <span class="filepath">debian/upstream/metadata</span> file as recommended by Debian
for package info.</li>
<li>Added <span class="filepath">xnec2c.spec</span> for RPM-based builds!  Just <code>rpmbuild -bb xnec2c.spec</code> to create an RPM.  You will need to place the latest
<span class="filepath">.tar.gz</span> file in <span class="filepath">~/rpmbuild/SOURCES</span> or run <code>spectool -g -R xnec2c.spec</code>
to download them for you. Thanks to Richard Shaw <span class="callsign">KF5OIM</span> for reviewing
the <span class="filepath">.spec</span> file!</li>
<li>Added include of <code>locale.h</code> to fix building under <code>musl-libc</code>. Thanks
to Tom <span class="callsign">DL1JBE</span> for pointing this out and testing the fix!</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.10</span></h3>
<p>Fixed crash caused memory allocation off-by-one error.  Thanks to Juan Pablo García, <span class="callsign">EA4CIV</span> for reporting the bug!
</p>


<h3>Version <span class="version-tag">4.4.9</span></h3>
<p>Minor fixes, both reported and tested by Juan Pablo García, <span class="callsign">EA4CIV</span>.  Thanks for your help!
<ul>
<li>
Fixed S<sub>11</sub> phase angle calculation for graphs and touchstone file export.
</li>
<li>
Fixed locale issues for numeric output data (touchstone, gnuplot, csv)
and for <span class="filepath">xnec2c.conf</span> when switching from one locale with period for
decimal point to another with comma for decimal point, or vice-versa.
</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.8</span></h3>
<p>This is a minor maintenance release.
<ul>
<li>Fixed buffer overflow in the temp string used in <code class="language-c">mem_write_format()</code>,
thanks to Juan Pablo García, <span class="callsign">EA4CIV</span> for reporting the bug while testing
touchstone file output.</li>
<li>Changed default Save-As filenames to resemble the original <span class="filepath">.nec</span> filename where appropriate.</li>
<li>Avoid EM calculation if the selected frequency step (when you
right-click on a graph) has already been calculated. Note that, at the
moment, it must always calculate if left-clicking the graph or when
"Show Currents" or "Show Charges" is selected.</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.7</span></h3>
<p>This release has a few minor features added:
<ul>
<li>Touchstone 1- and 2-port files (<span class="filepath">.s1p</span>, <span class="filepath">.s2p</span>) can be exported from the
frequency plots window.  Touchstone files are used by professional RF
software packages like Microwave Office, Sonnet, and others.   Now xnec2c
can export <span class="filepath">.s1p</span> and <span class="filepath">.s2p</span> files to be used with those software packages.
S<sub>11</sub> is the same as return loss, reflection and <span class="filepath">.s1p</span> files provide
single-port data.  Thanks to Juan Pablo García, <span class="callsign">EA4CIV</span> for suggesting this
feature.
</li>
<li>Converted frequency plot gnuplot output to include all columns. Now
all columns are available in the <span class="filepath">.gnuplot</span> file.  Thanks to <span class="github-user">@scaramacai</span>
on github for the initial work on this conversion.</li>
<li>Added auto-detection of <code>musl-libc</code> so it will compile for users
with <code>musl-libc</code>. Thanks to Tom, <span class="callsign">DL1JBE</span> at Gentoo for suggesting and testing
this change.</li>
<li>See the github changelog for the lovely details.</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.6</span></h3>
<p>This is mostly a release with a handful of bugfixes and some internal re-organization
in preparation for s1p/s2p output and gnuplot extensions (<span class="filepath">src/measurements.c</span>).
Detailed descriptions are available in the git log.
<ul>
<li>Removed C++ compiler dependency, xnec2c is written in C</li>
<li>Fixed default mathlib handling when no accelerated library is installed</li>
<li>Fixed error on first run when <span class="filepath">~/.xnec2c/</span> does not exist</li>
<li>Added libtool dependency to documentation for CentOS</li>
<li>Fixed segment fault when <code>HOME</code> environment variable is undefined.</li>
<li>Fix off-by-one error in memory allocation for frequency plot arrays.</li>
<li>Fixed deadlocks when running without pthreads and without forking.</li>
<li>Refactored common measurements into <span class="filepath">src/measurements.c</span></li>
<li>Refactored <span class="filepath">src/plot_freqdata.c</span> to use <code class="language-c">meas_calc()</code></li>
<li>Added function use comments to <span class="filepath">src/measurements.c</span></li>
<li>Suppress <code>max_freq&nbsp;==&nbsp;min_freq</code> when <code>freq_steps&nbsp;==&nbsp;1</code></li>
<li>Fixed gcc warning about the return value of <code class="language-c">getcwd()</code> not being checked.</li>
<li>Ignore the <code class="nec-card">GN</code> card if both <code class="nec-card">GN</code> and <code class="nec-card">GE</code> cards indicate freespace.</li>
<li>Fixed format-truncation compiler warning</li>
</ul>
</p>


<h3>Version <span class="version-tag">4.4.5</span></h3>
<ul>
<li>Corrected Im(-z) plotting on the Smith chart, it was plotting upside-down.  Thanks to Juan Pablo
    García <span class="callsign">EA4CIV</span> for pointing this out.</li>
<li>Updated examples with corrections from Neoklis related to ground configuration.</li>
<li>Updated GCC/Clang compiler optimization settings for better compatibility.</li>
</ul>
<p>See the git commits for detail if you're interested!
</p>


<h3>Version <span class="version-tag">4.4.4</span></h3>
<p>Fixed regression introduced in <span class="version-tag">v4.3</span> by adding <code>-ffinite-math-only</code> as a
gcc optimization.  This causes radiation patterns to draw incorrectly
when the <code class="nec-card">RP</code> card (radiation pattern card) when using a "Perfect Ground"
in the <code class="nec-card">GN</code> card at the same time that "Radial wire screen" is used as
the ground in the <code class="nec-card">RP</code> card.  Thank you Neoklis for investigating the examples
that produced the issue.
</p>


<h3>Version <span class="version-tag">4.4.3</span></h3>
<p>Added option to Round X-axis Frequency Values:
</p>

<p>X-Axis frequency values in the Frequency Data Plots window default to
scaling based on the total frequency range and number of points which
deviates from the way Neoklis originally implemented the plot.  This makes
the best use of graph space, however, this new form can create axis values
that do not align nicely to whole numbers or common fractions of numbers
(like 13.5 vs 13.72).
</p>

<p>The new option <span class="menu-path">View → Round X Axis Frequency Values</span> will align the X Axis
labels to normalized values as originally designed in releases prior
to <span class="version-tag">v4.1.5</span>.  When this option is off, it will show one more frequency
significant figure displayed on the X Axis and scale the plot to use
the entire plot space.
</p>


<h3>Version <span class="version-tag">4.4.2</span></h3>
<ul>
	<li>Fixed plot width drawing with multiple <code class="nec-card">FR</code> cards.  This fixes a regression that had disabled
	mouse-wheel scrolling to resize plots with multiple <code class="nec-card">FR</code> cards.</li>
	<li>Fixed Frequency_Loop race conditions causing access to uninitialized data that
	were seen as flickering while running the frequency loop, or as incomplete plot drawings.</li>
	<li>Added strerror on failed file open for <span class="github-user">@m-anish</span> on github to
	troubleshoot error opening <span class="filepath">xnec2c.conf</span>. </li>
	<li>Refactored memory handling routines to bypass <code>realloc()</code> if possible.  This increases
	performance slightly, reduces heap thrashing, increases stability by clearing memory
	on reallocation, and makes memory handling easier to debug.</li>
</ul>


<h3>Version <span class="version-tag">4.4.1</span></h3>
<p>Fixed graph scaling so that each point is drawn in order while running
	the frequency loop without rescaling the graph on the x-axis.  This way
	the points line up correctly to their frequencies throughout the plot
	while the frequency loop is running instead of only being correct after
	all points have been plotted. Thank you Neoklis for pointing this out!
</p>


<h3>Version <span class="version-tag">4.4</span></h3>
<ul>
	<li>The <span class="menu-path">File → Gain Scaling</span> setting is now saved between restarts
	since this is a visual preference per user.</li>
	<li>GTK resource refactor prevents the need to delete the old
	<span class="filepath">resources/xnec2c.glade</span> file on new releases that have UI changes. This is
	a pretty major change that should be transparent to users, so please report any regressions.</li>
	<li>Fixed a minor fsync() bug</li>
	<li>Updated installation details that will
	help distribution packagers.  Special thanks to Tom DL1JBE at
	Gentoo for his packaging feedback!</li>
	<li>Added a <span class="filepath">PACKAGING</span> file to help distribution packagers.</li>
</ul>


<h3>Version <span class="version-tag">4.3.5</span></h3>
<p>Updated documentation around <span class="filepath">autogen.sh</span> and added tests to make sure gettext and related tools are
	available for autoconf to complete successfully.
</p>


<h3>Version <span class="version-tag">4.3.4</span></h3>
<ul>
	<li>Fixed slow <code>sync()</code> issue by replacing it with <code>fsync()</code>.  Thanks to <span class="github-user">@bbarenblat</span> on github.</li>
	<li>Fixed typos and spelling errors throughout the application, thanks to <span class="github-user">@dforsi</span> on github.</li>
	<li>Updated documentation and added official website links</li>
</ul>


<h3>Version <span class="version-tag">4.3.3</span></h3>
<p>A few optimizer cleanups and bug fixes including updating CSV format to
remove extra whitespace and increase precision of the NEC2 data.  See git log for details.
</p>


<h3>Version <span class="version-tag">4.3.2</span></h3>
<p>Additional optimizer trigger and inotify cleanup.  Also xnec2c writes
the <span class="filepath">.csv</span> file as soon as the checkbox is selected to trigger any external optimizers waiting for
the <span class="filepath">.csv</span> to be modified.
</p>


<h3>Version <span class="version-tag">4.3.1</span></h3>
<ul>
<li>Added an option to show S<sub>11</sub> (dB) (negative return loss) as a plot next to VSWR. See
<span class="menu-path">Frequency Plots → View → Show S<sub>11</sub></span>
</li>
<li>Added an option to clamp VSWR to a max of 10 for graphing purposes.  In the past
xnec2c has always clamped to 10 so this option defaults enabled.  If you want to see the
entire VSWR curve no matter how big VSWR is, then see <span class="menu-path">Frequency Plots → View → Clamp VSWR to 10</span>.
</li>
<li>Fixed deadlock while optimizing when inotify receives a <span class="filepath">.nec</span> change before xnec2c
is done writing the <span class="filepath">.nec.csv</span> file.</li>
</ul>


<h3>Version <span class="version-tag">4.3</span></h3>
<ul>
<li>Changed maintainer to Eric Wheeler, <span class="callsign">KJ7LNW</span></li>
<li>Moved xnec2c to github: <a href="https://github.com/KJ7LNW/xnec2c">https://github.com/KJ7LNW/xnec2c</a></li>
<li>Major refactor of the plotting code:
	<ul>
		<li>Added multi-plot support when multiple <code class="nec-card">FR</code> cards are used.</li>
		<li>Added <span class="menu-path">View → Show Min/Max</span> values to the Frequency Data Plots
		  graph.</li>
		<li>Enable click+drag for continuous frequency selection.</li>
	</ul>
</li>
<li>Performance improvements:
	<ul>
		<li>30% speedup of native NEC2 code Gaussian Elimination code with
		  <code>-fcx-fortran-rules</code></li>
		<li>Added support for ATLAS, LAPACK, OpenBLAS and Intel MKL accelerated
		  linear algebra libraries. These are auto-detected at runtime on
		  CentOS/RHEL, Ubuntu/Debian, and openSUSE.</li>
		<li>Added benchmark and time reporting for math libraries</li>
		<li>Separated interactive vs batch math library to get the best of
		  parallel graphing performance as well as interactive single-frequency
		  performance.</li>
		<li>Prevent calculating frequency dependent data twice when the program
		  loads a new file.</li>
		<li>Removed synchronous GTK+ loops to increase responsiveness.</li>
		<li>Made GTK more responsive by converting Frequency_Loop() to run as
		  a pthread</li>
		<li>Made xnec2c always fork a child process for handling frequency data
		  calculations requested by Frequency_Loop even for <code>-j1</code> to prevent blocking
		  GTK during a calculation (disable forking with <code>-j0</code>)</li>
	</ul>
</li>
<li>Bug-fixes:
	<ul>
		<li>Fixed parallel job child communication races and better EINTR
		  handling</li>
		<li>Fixed multiple crashes when inotify detects a change of the <span class="filepath">.nec</span>
		  file while the frequency loop is running.</li>
		<li>Fixed uninitialized data program-wide by calling memset(0) in
		  mem_alloc().</li>
		<li>Fixed Clang compiler support and added auto-detection</li>
		<li>Fixed multiple multi-threaded fixes and optimization flicker
		  problems</li>
		<li>Prevent resetting the projection angle and zoom during
		  optimization</li>
		<li>Retry the optimization request after 100ms if there are busy child
		  processes.</li>
	</ul>
</li>
</ul>


<h3>Version <span class="version-tag">4.2</span></h3>
<p>Further to the changes above, I have
modified xnec2c so that more than one <code class="nec-card">FR</code> (frequency range) card can
be specified in the NEC2 file. This makes it possible to calculate
frequency-dependent parameters over separate ranges of interest and
thus reduces the time taken by the program to produce results.
Unnecessary calculations between ranges of interest are also
avoided.</p>


<h3>Version <span class="version-tag">4.1.5</span></h3>
<p>After an inquiry by Eric Wheeler <span class="callsign">KJ7LNW</span>
regarding the use of the <code class="nec-card">GH</code> card to create spirals, I found a bug
that caused the <code class="nec-card">GH</code> editor to delete the <code class="nec-card">GH</code> entry in NEC2 Editor's
treeview. I also found a bug that caused the number of turns of a
spiral to be rounded to the nearest integer. Both bugs have been
fixed in this version.</p>
<p>Further, to aid Eric Wheeler <span class="callsign">KJ7LNW</span> to develop his Simplex
automatic Optimizer, I added code to monitor, with inotify, the
<span class="filepath">.nec</span> input file and to trigger recalculation and plotting of
frequency dependent data, while at the same time printing to file
results (VSWR, max gain, F/B ratio etc). Also added code so that if
the user clicks on the Frequency Plots drawing area, the underlying
frequency is saved and re-entered into the frequency-dependent
calculations. This, together with maintaining the viewing angle of
the Radiation pattern makes it easier to monitor the Optimizer's
progress.</p>


<h3>Version <span class="version-tag">4.1.4</span></h3>
<p>Added the <code>stdint.h</code> include file to
<span class="filepath">src/common.h</span> to fix a compilation error reported by Nick <span class="callsign">G3VNC</span>.</p>


<h3>Version <span class="version-tag">4.1.3</span></h3>
<p>Arranged the pipe reading function for the
parent process to re-read from the child processes if not all data
is transferred at the first read(). In this case xnec2c was
crushing with "Resource temporarily unavailable" error message.</p>


<h3>Version <span class="version-tag">4.1.2</span></h3>
<p>Changed the installation commands in
<span class="filepath">Makefile.am</span> so that all the relevant files (<span class="filepath">files/xnec2c.desktop</span>,
application pixmap, configuration file, executable binary etc) are
installed under any location specified to the configure script by
the <code>--prefix=</code> option. Also modified the program so that on first
start up after installation, the application will create its
working directory by copying files from the relevant directories
under the installation prefix.</p>


<h3>Version <span class="version-tag">4.1.1</span></h3>
<p>I made a small change to the Radiation
Pattern code to allow the drawing of both horizontal an vertical
"cuts" in the radiation pattern, in the zx and zy vertical planes
and the xy horizontal plane. Also changed the accelerator keys for
the Add, Remove, Clear, Save As, Save and Revert buttons to be
Modified by the Control button as the original accelerator keys
were being activated when writing in the Comments Treeview.</p>


<h3>Version <span class="version-tag">4.1</span></h3>
<p>I corrected some mistakes in the GUI
interface code, which handles the creation of windows and dialogs
from the glade UI description file. These mistakes were such that
they did not effect the operation of xnec2c but in any case I fixed
them for the sake of correct programming. Also changed the wire
designer dialog to include the Tapered Wire selection check-button
in the dialog's frame and the relevant code to deal with this
better.</p>


<h3>Version <span class="version-tag">4.0</span></h3>
<p>I corrected some mistakes in the GUI
interface code, which handles the creation of windows and dialogs
from the glade UI description file. These mistakes were such that
they did not effect the operation of xnec2c but in any case I fixed
them for the sake of correct programming. Also changed the wire
designer dialog to include the Tapered Wire selection check-button
in the dialog's frame and the relevant code to deal with this
better.</p>


<h3>Version <span class="version-tag">4.0</span></h3>
<p>I have changed the code that saves the state
of the View-Polarization menu items, as it would only correctly
save the state of these items in the Main (structure) window. I
also changed the code that handles the removal of "card" entries in
the NEC2 editor, as it was causing crashes of xnec2c under some
user action combinations.</p>


<h3>Version <span class="version-tag">3.9</span></h3>
<p>Since I have not received any bug reports
for some time after releasing <span class="version-tag">v3.9-b</span>, and having fixed a bug
that resulted in a <code class="language-c">gtk_widget_destroy()</code> command to be passed on an
invalid widget pointer, I am releasing xnec2c as <span class="version-tag">v3.9</span>.</p>


<h3>Version <span class="version-tag">3.9-beta</span></h3>
<p>I have arranged for some user actions
to be "nested", mainly regarding the saving of NEC2 editor data
followed by the opening of another file or starting a new project.
Some such functionality already existed in previous versions but it
is now more comprehensive.
Another useful change is fixing a bug in the original NEC2 code for
producing a helix (as specified by the <code class="nec-card">GH</code> "card"). This bug
resulted a division by zero if the helix length was specified as
zero, possibly intended to produce a spiral. The <code class="nec-card">GH</code> card can now be
used to produce both a helix or a spiral with no floating point
exceptions.</p>


<h3>Version <span class="version-tag">3.8-beta</span></h3>
<p>I edited some of the code so that when
a NEC2 file is saved, the Center x and y offsets (the change of
position) of the structure and radiation pattern are not changed. I
also arranged for the offset values to be saved in
<span class="filepath">~/.config/xnec2c.config</span> when closing xnec2c, and to be read back
and restored when starting.</p>


<h3>Version <span class="version-tag">3.7.1-beta</span></h3>
<p>Fixed a reported bug that prevented
wire diameter entries less than 0.01 in the Helix (<code class="nec-card">GH</code>) card editor.
This was due to specifying a minimum value of 0.01 in the
<span class="filepath">resources/xnec2c.glade</span> file.</p>


<h3>Version <span class="version-tag">3.7-beta</span></h3>
<p>After some feature requests by users of
xnec2c, I implemented a number of changes to xnec2c so that it can
save the state of the GUI at exit and restore it on start up. To
this effect xnec2c now produces a configuration file <span class="filepath">xnec2c.config</span>
in the user's <span class="filepath">~/.config</span> directory. In this file xnec2c saves the
state (position, size, active toggle buttons, projection parameters
for structure and radiation pattern displays, the state of the
frequency loop etc) of the main windows, e.g.&nbsp;structure, radiation
pattern, frequency plots and NEC2 editor.
I have also added keyboard accelerators for a number of buttons and
menu items, more commonly used in the main windows of xnec2c, and a
new <code class="nec-card">ZO</code> NEC2 "card" to specify transmission line impedance.</p>


<h3>Version <span class="version-tag">3.6.1-beta</span></h3>
<p>After a request by Don Walters <span class="callsign">W9DKI</span>
I modified the <span class="filepath">resources/xnec2c.glade</span> file to reduce the default size of the
drawing areas as they would not fit in displays with reduced
resolution. I also removed some legacy code, left over from the
migration of xnec2c to GTK3, which was producing error messages
from GTK3 during the dragging of structure or radiation pattern
displays. And I modified the <span class="filepath">Makefile.am</span> file to get <code>make install</code>
to install program files and documentation to the right places.</p>


<h3>Version <span class="version-tag">3.6-beta</span></h3>
<p>I migrated Xnec2c to the latest
<code>GTK+-3.22</code> toolkit to bring it up to date. A lot of changes were
needed to both the GUI and parts of the Xnec2c source code, mainly
the use of GTK3's GUI Builder for creating the User Interface and
the revised drawing model of GDK for presenting the Graphics
displays. A new <span class="filepath">autogen.sh</span> script has also been incorporated in the
source package and internationalization has been migrated to the
GNU GetText system. Because Xnec2c is very complicated and thorough
testing is difficult, I am releasing this version as a beta.</p>


<h3>Version <span class="version-tag">3.5.1</span></h3>
<p>After a request by Fan Jun <span class="callsign">BH1SCW</span>, I
replaced the original makeshift desktop icon with one provided by
Serge <span class="callsign">ON4AA</span>.</p>


<h3>Version <span class="version-tag">3.5</span></h3>
<p>I modified the NEC2 Editor code so that when
a Geometry or Command editor window is opened, activating Apply or
OK will save data in the editor window to the treeview, even if the
default data is not edited.</p>
<p>I modified the NEC2 Editor code so that if a treeview row is
removed while the relevant editor window is open, then activating
Apply or OK will not attempt to save data to the treeview, since
this will cause an illegal memory access and will crash xnec2c.</p>
<p>Fixed a bug in the Helix editor which caused incorrect calculation
of the segment length as a percentage of <var>λ</var> or of the
number of segments/turn that correspond to a given segment length
as a percentage of <var>λ</var>.</p>


<h3>Version <span class="version-tag">3.4</span></h3>
<p>I fixed a bug in the code that implements
the modified <code class="nec-card">GS</code> (scaling) card. In NEC2 the <code class="nec-card">GS</code> card scales all of
the structure, but in Xnec2c I modified the code so that it is
possible to specify a range of tag numbers to apply scaling to
only. When a <code class="nec-card">GS</code> card follows a <code class="nec-card">GX</code> card, selective scaling doesn't
work correctly because a symmetric structure is created. If you are
using a <code class="nec-card">GS</code> card, it may be better to avoid specifying a tag number
range, just in case the bug fix is not complete.</p>


<h3>Version <span class="version-tag">3.3</span></h3>
<p>I fixed a bug that was in the code that
reads the commands from the NEC2 input file, where xnec2c would
crash with a segmentation fault when the <code class="nec-card">FR</code> card was after the <code class="nec-card">RP</code>
card. Also modified the <code class="language-c">Strtod()</code> function to avoid freeing the end
pointer before it was used, causing problems.</p>


<h3>Version <span class="version-tag">3.2</span></h3>
<p>I made some changes to the <code class="language-c">Strlcat()</code>
function and its usage in the xnec2c code, to improve safe handling
of string concatenation operations. Hopefully this has not broken
the handling of various strings in xnec2c!</p>


<h3>Version <span class="version-tag">3.1</span></h3>
<p>I have made several changes to the code that
renders wire frame drawings and displays some data, like the
projection parameters (azimuth and elevation of the structure and
the radiation pattern) and gain values. This has resulted in a
faster and smoother animation of these drawings and reduced
workload on the processor during dragging of these images.
I have also reduced the default minimum size of xnec2c's windows,
as I had reports that they would not fit in the displays of some
laptops or monitors, with resolutions on the lower side.</p>


<h3>Version <span class="version-tag">3.0</span></h3>
<p>I have modified the NEC2 file parser so that
it can read the file with both the '.' and ',' as decimal point
characters. This is necessary to make xnec2c compatible with
different locales. I also fixed a resource (memory) leak, reported
by <code>valgrind</code>, in the xyz axes drawing routine.</p>


<h3>Version <span class="version-tag">2.9</span></h3>
<p>After a request by the Debian maintainer of
xnec2c, I added a rudimentary man page he sent me and corrected
some spelling errors (arbitrary to arbitrary).</p>


<h3>Version <span class="version-tag">2.8</span></h3>
<p>Fixed a bug in the <code class="nec-card">GN</code> card editor function
which caused xnec2c to save the <code class="nec-card">GN</code> card parameters in the <span class="filepath">.nec</span>
antenna description file without clearing the number of radials to
zero. This resulted in the <code class="nec-card">GN</code> card editor window to open with
confusing and incorrect defaults for the radial screen, when the
Reflection Coefficient Approximation method was selected for
specifying ground parameters.</p>
<p>Also fixed some bugs (missing variable initializations) in the
Ground Parameters calculation functions which resulted in incorrect
Radiation Pattern calculations. This would happen if a <span class="filepath">.nec</span> file,
with Perfect Ground (<code>iperf = 1</code>) specified in the <code class="nec-card">GN</code> card, was
opened after a <span class="filepath">.nec</span> file, with a Radial Ground Screen specified in
the <code class="nec-card">GN</code> card, was processed.</p>


<h3>Version <span class="version-tag">2.7</span></h3>
<p>After a bug report by Tim, <span class="callsign">WJ5Q</span>, I fixed a
bug that was preventing the creation of an <code class="nec-card">LD</code> card of type 5
(<code>LDTYP=5</code>) when wire conductivity (S/m) was specified in the <code class="nec-card">GW</code> card
(Wire) editor. The same bug was present in the <code class="nec-card">GH</code> (Helix) card
editor and it was also fixed. I added code so that the wire
conductivity for <code class="nec-card">GW</code>, <code class="nec-card">GA</code> and <code class="nec-card">GH</code> cards can be read from the relevant
<code class="nec-card">LD</code> card and shown in the Conductivity (S/m) spin button.</p>
<p>After all these changes I checked the xnec2c source code using
the Coverity Scan service and I fixed an out-of-bounds read error
that was reported by the scanner, in the <span class="filepath">src/plot_freqdata.c</span> file.</p>


<h3>Version <span class="version-tag">2.6</span></h3>
<p>After a bug report by Lucjan <span class="callsign">SQ9VPA</span>, I
changed the case of the signal handler that deals with <code class="signal">SIGCHLD</code> so
that it doesn't cause xnec2c to exit when the <code class="signal">SIGCHLD</code> signal does
not originate from child processes created by xnec2c. It appears
that in some Linux installations a <code class="signal">SIGCHLD</code> signal is sent to xnec2c
even if it is not running forked, e.g.&nbsp;the <code>-j</code> option is not used in
the command line.</p>


<h3>Version <span class="version-tag">2.5</span></h3>
<p>After a bug report by Jean Collin, I made
some changes to the input file parser code in <span class="filepath">src/input.c</span>, to properly
identify tabs in the input file.</p>


<h3>Version <span class="version-tag">2.4</span></h3>
<p>I submitted xnec2c (and nec2c) for scanning
to the <a target="_blank" rel="noopener noreferrer" href="https://scan.coverity.com/" name="coverity" id=
"coverity">Coverity</a> source code audit website, which produced a
list of no less than 57 issues to be fixed! Most of them were not
bugs that affected calculations but possibly two, both in the
Somnec code, one in function <code class="language-c">rom1()</code> and one in <code class="language-c">gshank()</code> likely
could have caused errors in the relevant calculations.
Unfortunately the FORTRAN source of Somnec (as well as that of the
NEC2) is very difficult to read so I cannot say with certainty if
this was so.</p>


<h3>Version <span class="version-tag">2.3-beta</span></h3>
<p>Fixed a bug in the
<code class="language-c">cell_edited_callback()</code> function that caused segmentation fault
crashes when a cell in the input file editor was edited directly by
the user.</p>


<h3>Version <span class="version-tag">2.2-beta</span></h3>
<p>I made extensive modifications to the
source code to silence a large number of warnings generated by the
<code>LLVM clang</code> compiler when used with the <code>-Weverything</code> option. These
were mostly cases of implicit conversions between variable types,
like <code>int</code> to <code>char</code> or <code>uint</code> to <code>int</code> etc. I have also updated the basic
files of the GNU Autotools build system, to be compatible with the
current version of these tools at the time of writing (February
2013).</p>


<h3>Version <span class="version-tag">2.1</span></h3>
<p>Patched a problem in the graph plotting
routines that caused xnec2c to crash with a division by zero fault.
This can happen when e.g.&nbsp;a single-wire structure is specified and
a plot of gain vs frequency is requested, for a polarization that
is at 90° to the wire, e.g.&nbsp;requesting gain plot for horizontal
polarization for a vertical wire. Since there is no radiation in
the horizontal plane of a vertical wire, the values of gain given
to the plotting routines are all the same so the vertical scale
drawing routines crash xnec2c.</p>
<aside class="notice" role="note">
<h4>Note</h4>
<p>Although xnec2c
will now not crash as above, the plots will be jumbled and
meaningless.</p>
</aside>


<h3>Version <span class="version-tag">2.1-beta</span></h3>
<p>I have introduced many changes in this
version, so I am releasing it again as a public beta version for
testing and bug reports:</p>
<p>After a bug report by David J. Singer, I changed all declarations
of variables that are used in memory allocations, from <code>int</code> to
<code>size_t</code>. This error was in the nec2c code from the beginning but
apparently it only showed up when extremely large memory
allocations are requested in nec2c and xnec2c.</p>
<p>I have replaced all the (deprecated) GDK drawing primitives with
equivalent Cairo graphics equivalents (e.g.&nbsp;replaced
<code class="language-c">gdk_draw_line()</code> with <code class="language-c">cairo_line_to()</code>) since Cairo provides for
nicer anti-aliased drawing.</p>
<p>After a feature request by David J. Singer and friend Richard, I
have added code to save data of the structure display, radiation
patterns and frequency plots into file, in a format suitable for
the <code>gnuplot</code> plotting program.</p>


<h3>Version <span class="version-tag">2.0-beta</span></h3>
<p>I received a bug report from David
Binderman regarding an array bounds violation, which he found by
compiling xnec2c with the <code>-D_FORTIFY_SOURCE</code> gcc flag. I fixed this
bug and also tested xnec2c source code using <code>cppcheck</code>.</p>
<p>I decided it was about time I modify the xnec2c user interface so
that it will, as far as possible, allow the user to save and
re-open NEC2 files in the Editor window, without closing the
Radiation Pattern and/or the Frequency Plots windows. This will
significantly speed up work on editing NEC2 files and also make
xnec2c usage less awkward. However, many bugs were introduced and
fixed during this re-write of xnec2c, so users are advised to be
watchful of possible bugs that got away and to report them for
fixing.</p>


<h3>Version <span class="version-tag">1.6</span></h3>
<p>I received another bug report from Rik van
Riel: The patch applied above did not help, as somehow the buggy
code got duplicated below the bug fix, reproducing the same error
in the calculation of front-to-back ratio! Hopefully fixed this
time.</p>


<h3>Version <span class="version-tag">1.5</span></h3>
<p>Changed the handling of command line
arguments so that the input file name may be specified without the
use of the <code>-i</code> option. In this case xnec2c will take the last
argument to be the input file name, but only if it has the <span class="filepath">.nec</span>
extension.Got rid of some variables that were set but not used, according to
warnings given by gcc.Applied a patch supplied by Rik van Riel to allow the calculation
of front to back ratios when the antenna is modeled over
ground.</p>


<h3>Version <span class="version-tag">1.4</span></h3>
<p>Applied a patch supplied by Tom Beierlein,
<span class="callsign">DL1JBE</span>, to fix crashing of xnec2c <span class="version-tag">v1.3</span> on long input file names
(&gt; 80 characters).</p>


<h3>Version <span class="version-tag">1.3</span></h3>
<p>After an inquiry about using incident field
excitation, which was not implemented in previous versions, I
removed the restrictions in excitation to allow plotting the
re-radiated pattern from a structure excited by incident field or
elementary current source. However, the calculations are carried
out only for one set of angle-of-incidence angles, e.g.&nbsp;there is no
stepping of the <var>θ</var> and <var>φ</var> angles. This would require much more
complex changes to xnec2c and I am not currently able to do
this.</p>


<h3>Version <span class="version-tag">1.2</span></h3>
<p>Made the page size of spin buttons 0 to make
setting of spin button values compatible with GTK 2.4</p>


<h3>Version <span class="version-tag">1.1</span></h3>
<p>I spoke too soon! A segfault bug has been
reported that occurs when Maximum Admittance Matrix Asymmetry
printing is requested in the <code class="nec-card">EX</code> card. Although this is not
supported in xnec2c, it still produces a segmentation fault because
the <code>ipnt</code> buffer is not allocated in the <code class="language-c">netwk()</code> function in
<span class="filepath">src/network.c</span></p>


<h3>Version <span class="version-tag">1.0</span></h3>
<p>After several months with no bug reports or
feature requests, I am sticking my neck out and releasing xnec2c as
<span class="version-tag">v1.0</span>. This version incorporates the last two feature request
I received from users:
The "Cancel" button on card editors has been replaces with a
"Delete Card" button, which deletes the selected "card" (row in the
NEC2 editor window).
A "Net Gain" menu item has been added to the View menu of the
Frequency Plots window to replace the second plotted quantity with
the Net Gain of the antenna.</p>


<h3>Version <span class="version-tag">1.0b5</span></h3>
<p>Following on the above changes, I revised
all similar situations in xnec2c's source and modified all
<code class="language-c">sprintf</code> commands to <code class="language-c">snprintf</code> just in case, as I could not
replicate the bug so could not test for other similar problems. I
also fixed a bug in the "save" and "save as" handler, to avoid
false attempts by xnec2c to save structure and radiation
pattern/frequency plots pixmaps when a save of the NEC2 editor data
failed for some reason.</p>


<h3>Version <span class="version-tag">1.0b4</span></h3>
<p>After a bug report from Juha Vierinen I
changed some <code class="language-c">sprintf</code> commands to <code class="language-c">snprintf</code> to avoid buffer
overruns.</p>


<h3>Version <span class="version-tag">1.0b3</span></h3>
<p>Added <code>setlocale(LC_NUMERIC, "C");</code> to the
<code class="language-c">main()</code> function, so that in locales where commas are used in
decimal numbers xnec2c can read data correctly (suggested by Joop
Stakenborg). Some minor changes to the user interface were also
made to allow the NEC2 editor window to fit in displays with
shorter heights.</p>


<h3>Version <span class="version-tag">1.0b</span></h3>
<p>In this version xnec2c has been re-worked
extensively to make it multi-threading and to streamline its
operation to some extend. Many bugs created by these changes, and
others that already existed have been fixed, and the user interface
has also changed somewhat. The example input files have also been
checked and some mistakes in them have been corrected. This is now
the first <span class="version-tag">v1.0</span> beta release for public testing.</p>


<h3>Version <span class="version-tag">0.9b</span></h3>
<p>Fixed a few bugs mainly in the NEC2 editor
code and also changed the code of all individual Geometry and
Command editors, so that edited data are set in the main NEC2
editor's tree views when another Geometry or Command card (tree
view row) is selected for editing.</p>
<p>Implemented a work round around a serious bug which I could not
trace, since it now seems to be outside my code: When the <code class="language-c">zint()</code> or
<code class="language-c">fbar()</code> functions are called, they seem to corrupt xnec2c's memory
allocation when they return. This corruption manifests itself as
NAN values appearing in calculations so I modified these functions
to return their computed value via a pointer in the argument list.
I also changed the function declaration from <code>complex long double</code> to
void as it seems this bug is related to functions of the former
type declaration, returning a value.</p>


<h3>Version <span class="version-tag">0.8b</span></h3>
<p>Fixed a serious bug that caused
segmentation faults and crashes in structures that have a wire in
contact with a patch. The <code class="language-c">subph()</code> routine divides this patch into 3
or 4 sub-patches so the total number of patches increases. There
was no provision to reallocate and initialize buffers used in
rendering patches in the structure display window. Other minor bugs
were also fixed and the example NEC2 files were also checked and
edited when needed.</p>


<h3>Version <span class="version-tag">0.7b</span></h3>
<p>Fixed a bug in the co-ordinate translation
(Move) editor and edited the code in the <code class="nec-card">GW</code> card editor so that the
wire diameter does not change when the New button is clicked.</p>


<h3>Version <span class="version-tag">0.6b</span></h3>
<p>Fixed a bug inherited from NEC2: If no
geometry cards are present (only a <code class="nec-card">GE</code> card) then there is division
by zero in <code class="language-c">conect()</code>. NEC2 seems to accept the lack of geometry
cards, this is now an error condition in xnec2c. Reduced the max
value specification of the Capacitance spin button in the Loading
card editor, from 1.0e+12 to 1.0e+9 (pF) since the higher value is
beyond the range of the <code>long</code> type in 32 bit systems. Modified the
behavior of some card Editors to make them more user friendly.</p>


<h3>Version <span class="version-tag">0.5b</span></h3>
<p>Fixed a bug that caused segmentation faults
when only one wire segment was present in the structure. This is
not a case that will normally exist but the seg fault had to be
fixed.</p>


<h3>Version <span class="version-tag">0.4b</span></h3>
<p>Added a NEC2 input file editor that makes
the edit/save/reload/execute cycle easier and quicker.</p>


<h3>Version <span class="version-tag">0.3</span></h3>
<p>Added the ability to stop the frequency loop
by clicking on the frequency display spin buttons and to restart it
by toggling the "Gain" or "E/H" buttons in the Radiation Pattern
window.</p>


<h3>Version <span class="version-tag">0.2</span></h3>
<p>Incorporated some changes to the GUI (the
Glade-generated design) since after upgrading to <code>GTK+ 2.8.9</code>, the
geometry of the windows (the position and extend of buttons/entry
widgets) changed a little. Also fixed some bugs in the GUI code to
handle unusual sequences of user actions correctly.</p>


<h3>Version <span class="version-tag">0.1</span></h3>
<p>First version with ability to draw a
color-coded wire frame Radiation Pattern (Near and Far Field),
Graphs of various Frequency dependent data (Gain, VSWR, Impedance
etc) and the Structure (Wires/Patches), including a color coded
Current or Charge distribution.</p>


<h2 id="Limitations">Limitations</h2>
<p>Since xnec2c is interactive, it cannot operate in the same way
as NEC2 or nec2c. Specifically, commands that cause execution in
NEC2/nec2c (<code class="nec-card">XQ</code>, <code class="nec-card">RP</code> etc), are only read in but not acted upon unless
the user requests the display of relevant data. For example, if an
<code class="nec-card">RP</code> command line is included in the input file, xnec2c reads the
relevant data from that line but does not calculate/render the
radiation pattern, until the user requests this by opening the
<a href="#RadiationWindow">Radiation Pattern window</a> and
clicking on the <strong>Gain</strong> button. In addition, the NX and <code class="nec-card">WG</code>/<code class="nec-card">GF</code>
commands are not recognized since only one structure at a time can
be input and evaluated, and the Numerical Green's function is not
needed or implemented. Also, some options of certain commands (e.g.&nbsp;
the surface wave option <var>I1</var>&nbsp;=&nbsp;1 of the <code class="nec-card">RP</code> command) are not implemented
and they must not be used since they will disrupt or even crash
xnec2c.</p>
<p>There are advantages deriving from the interactive operation: it
is possible, for example, to specify both the <code class="nec-card">NE</code> and <code class="nec-card">NH</code> commands in
combination with a multiple-frequency <code class="nec-card">FR</code> card, although only the
relevant data of the last command will be used.</p>
<h3 id="NoOutFile">No Output File</h3>
<p>Printing of results to an output file has been removed starting
from <span class="version-tag">v1.0</span>, since xnec2c works in a way that does not allow
printing compatible with the original NEC2 output format. If printing to file is
needed then it is better to use the original NEC2 program.</p>
<h2 id="Bugs">Bugs and Inadequacies</h2>
<p>
Xnec2c is based on nec2c, my translation to C of the original
FORTRAN NEC2 code. Any bugs discovered in nec2c will affect xnec2c
as well and they will have to be fixed. In addition, changing the
flow logic of nec2c, from a non-interactive batch-processing
command line tool to a GUI-based interactive application, was
rather complex and introduced many bugs that were fixed, but it is
always possible that a combination of some input file with an
untested sequence of user actions may trigger a hidden bug. Such a
case in fact did appear and it was traced to a bug in the original
NEC2 code. This has been fixed by G. Burke and the fix has been
incorporated in nec2c and xnec2c. See the <span class="filepath">doc/NEC2-bug.txt</span> file for
details.</p>
<p>When xnec2c was made multi-threading, a lot of bugs appeared and
were fixed but again there may be some that have not showed up. One
condition that did appear a couple of times was xnec2c getting
blocked in a select() call, waiting for a child to write to a pipe.
This apparently happened because I was testing a very minimal input
file and the child processes seemed to write to the pipes before
the parent process dropped into select(). This was fixed in <span class="version-tag">v4.3</span> by
always sending full-length filenames to the job children. If this seems
to happen, then please send a bug report with as much detail as possible
to reproduce the problem.
</p>
<p>A known inadequacy of xnec2c is the slowness of the animation of
displayed drawings, e.g.&nbsp;the structure itself, the radiation
pattern, near fields pattern etc. Specifically, dragging these
drawings with the mouse to rotate or incline them seems very heavy
on processor loading, and with most structures the movement is
jerky. This is my first attempt at animated wire frame drawings and
I lack experience with GTK3 in this field, so I probably went about
this the wrong way. I am open to any suggestions that may solve
this problem!</p>
</main>
<footer role="contentinfo">
<h2 id="Acknowledgement">Acknowledgment</h2>
<p>
Some of the code in xnec2c is based on Pieter-Tjerk de Boer's
"xnecview" application, which visualizes NEC2's input and output
files. The general 'look and feel" of xnec2c was also influenced by
the same application.</p>
<p><strong>Author:</strong> Neoklis Kyriazis (Ham Radio call: 5B4AZ)</p>
</footer>
</body>
</html>
